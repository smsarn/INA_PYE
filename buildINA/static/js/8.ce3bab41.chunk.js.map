{"version":3,"sources":["components/OutputPDFEP.js","components/OutputGraphsEPLeakage.js","components/OutputGraphStacked.js","components/outputPresentationEP.js","components/GridExcelComponent/DownloadExcel.js","components/GridExcelComponent/ExcelToolbar.js","components/GridExcelComponent/DataTable.js","components/PDF.js"],"names":["setFontForTitle","pdf","lang","size","SetFont","HELVETICA","NORMAL","undefined","SetFontSize","PxToPt","BOLD","SetTextColor","addNote","para","left","paraY","paraWidth","setFontForParas","insertPara","TIMES","insertBullet","bullet","y","Text","InToPt","MultilineText","insertTableTitle","paraLeft","values","height","paraWidths","fillColor","fill","tableRow","insertTableRow","bold","align","insertGrid2","grid","LE","wrappedTitleBar","orientation","startYr","mode","i","cols","dataColTitles","length","max","decimalChar","thousands","Widths","AddPage","paragraph","OUTPUTTEXTEP","pg8T","pg3T","pg8P1","pg8P2","push","totalGridWidth","goodWidth","textWidth","widthTotal","goodWidthMultiLine","addMore","textWidthMultiLine","gridTitle","height2","rows","FooterLandscape","pgFooter","String","dataProjection","formatMoney","parseFloat","cleanFormat","toString","Footer","OutputGraphsEPLeakage","props","k","AssetLiabProjs","getAssetLiabProjections","this","dataInput","Presentations","language","totalLiabProjections","getProjectedLiabilities","projectEnd","probate","dtaAgesAll","lifeExp","clients","Clients","age","Math","min","QUOTE_SPOUSE","Age","QUOTE_CLIENT","INAEstateOption","lifeExpClient","lifeExpJLTD","leakageGraps","getLeakageGraphs","Assets","assetProjections","optionsPieEstateLeakage","legend","labels","boxWidth","optionsPieEstateLeakageLE","style","width","className","graphsLeakageT1","id","data","dataPieEstateLeakage","options","dataPieEstateLeakageLE","React","Component","OutputGraphStacked","optionsEstate","elements","point","radius","responsive","title","display","position","text","pg4GT","fontSize","fontColor","scales","yAxes","stacked","ticks","beginAtZero","callback","value","index","Intl","NumberFormat","format","replace","xAxes","dataAssetnEstateLiabProj","type","col","taxLiab","TOTALS","TAX_LIAB","name","taxLiabLine","dataAges","colour","shadeColor","label","borderColor","backgroundColor","color","percent","R","parseInt","substring","G","B","dataEstate","datasets","marginLeft","overflow","float","OutputPresentationEP","doINA","a","window","parent","postMessage","encryptedInputLife1AndSpouse","clickMultiButton","e","showGrids","setState","doPDF","PDF","Create","output","getOutputValues","INAOption","TITLES","appletINA","appletEP","result","image","adviserLogo","headerOffset","top","addCustomImage","IMAGE_LOGO","AddImage","IMAGE_APPLET_EP","pg1TitleY","pg1P1","designedFor","pg1P2","designedBy","pg1P3","dateApplet","pg1P4","province","footerText","headerText","pg1T","addFooterAndHeader","IMAGE_LOGO_OTHERPAGES","pg2T","parag","pg2Paragraphs","map","item","pg3P1","tableWidthAss","totalAssets","tmpY","pg3TabT","assets","element","ASSETS","OTHER_ASSETS","formatMoney2","pg3Tab2RTot","otherAssetsList","tableWidth","totalLiabs","tableLeft","pg3Tab2T","liabilities","pg3Tab2NW","pg3T2","pg3P2","pg3Tab3R1C1","pg3Tab3R1C2","pg3Tab3R1C3","pg3Tab3R1C4","pg3Tab3R2C1","EstateLiabsByTypeGrowth","ASSET_TAX_TYPE_REAL_ESTATE","EstateLiabsByType","EstateLiabsByTypeLE3","pg3Tab3R3C1","ASSET_TAX_TYPE_STOCKS","pg3Tab3R4C1","ASSET_TAX_TYPE_SMALL_BUS","pg3Tab3R5C1","ASSET_TAX_TYPE_RRSP","pg3Tab3R6C1","ASSET_TAX_TYPE_INTEREST","pg3Tab3R7C1","ASSET_TAX_TYPE_OTHER","pg3Tab3R8C1","EstateLiabsByTypeTotal","EstateLiabsByTypeLE3Total","pg3P4","pg3P5","pg4T","pg4P1","AddChart","pg4P2","pg4P3","drawRect","pg5T","pg5Paragraphs","pg5Plast","pg6T","pg6Paragraphs1","pg7T","pg7P1","aggregateGrid","j","pg9T","pg9P1","pg9P2","showOnPage","alert","Save","error","doSavePdfActionEP","doPrint","mywindow","open","document","write","getElementById","innerHTML","close","focus","print","state","loading","imageSize","imageAlign","nextProps","styleWithLogo","overflowX","loaded","AssetnEstateLiabs","startAge","getAgesEP","p2","p5","p6","projectionsGrids","class","allPages","images","getLogoAndAppletImage","imageRemove","imageAdjust","logoTop","logoBottom","marginTop","marginRight","paddingRight","onClick","CONTROLTITLE","clear","paddingTop","Info","infoIcon","getInfoExportINA","logo1stPage","applet","key","paddingLeft","whiteSpace","colSpan","textAlign","pg3P3","fontFamily","paddingBottom","insuranceNeed","dataEstateLiability","dataNAAges","showLeakageOnly","overflowY","MultiButtons","noButtons","buttonCaption","pg8O1","pg8O2","selected","selectMultiButton","DataTable","gridIcons","specialRow","ExcelFile","ReactExport","ExcelSheet","DownloadExcel","dataCell","styleCell","alignment","horizontal","font","numFmt","styleCellCol1","styleCellAlt","patternType","fgColor","rgb","styleCellAltCol1","styleTitleRowInfo","wrapText","border","bottom","right","styleCellLeftAllign","styleTitleRow","excelColumnsDataInfoSection","dataBodyTitles","dataBody","dataRow","indexOf","isNaN","excelColumnsHeaders","sz","wpx","excelColumnsDataMain","multiDataSet","columns","xSteps","ySteps","tempDate","Date","date","getDate","toLocaleString","month","getFullYear","downloadNow","hideElement","filename","APPLET_INA","dataSet","ExcelToolbar","handleClick","setExcel","classes","marginBottom","margin","padding","excelToolbarText","Fragment","Tooltip","placement","IconButton","xmlns","viewBox","d","Datatable","getMuiTheme","createMuiTheme","typography","fontWeight","overrides","MUIDataTable","tableRoot","paper","boxShadow","borderBottom","borderRight","MuiTableRow","root","head","footer","MuiTableCell","sizeSmall","MUIDataTableToolbar","titleRoot","icon","MUIDataTableBodyCell","MUITypography","body2","MUITablePagination","caption","downloadExcelNow","unit","divStyle","innerWidth","styleHeader","zIndex","customHeader","column","TableCell","filter","customHeadRender","captions","GRID_INTERNAL_CAPTIONS","excel","filterType","selectableRows","resizableColumns","selectableRowsHeader","viewColumns","search","download","textLabels","pagination","rowsPerPage","displayRows","of","setTableProps","downloadOptions","separator","onDownload","buildHead","buildBody","customRowRender","dataIndex","rowIndex","dataI","Typography","TableRow","customToolbar","theme","gridColumnsDataExcelInfoSection","in_","px","imageID","x","w","h","imgData","imgProps","getImageProperties","pdfHeight","addImage","AddImageFitWidthOnly","maxHeight","firstPage","FOOTER_TEXT_IN_Y","containerID","containerElement","canvasElement","getElementsByClassName","dataUrl","toDataURL","AddCanvas","canvasID","addPage","jsPDF","ShowGrids","Grid","setFontSize","setFont","setTextColor","textRed","textGreen","textBlue","fontName","fontStyle","textLines","splitTextToSize","DrawLine","line","Reset","fileName","save","red","green","blue","SetFillColor","setFillColor","fillRed","fillGreen","fillBlue","Rectangle","roundedRect","arrayText","split","minWidth","getTextWidth","adjustTextWidth","textColor","box","rightAlign","textY","textOut","xi","setDrawColor","rect","RightText","CenterText","tw","Header","textH","textF","addFooter","addHeaderNoFooter","tableRowSingle","values2","coloured"],"mappings":"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","file":"static/js/8.ce3bab41.chunk.js","sourcesContent":["import {\r\n  TITLES,\r\n  ASSETS,\r\n  IMAGE_LOGO,\r\n  IMAGE_LOGO_OTHERPAGES,\r\n  IMAGE_APPLET_EP,\r\n} from \"../definitions/generalDefinitions\";\r\nimport { OUTPUTTEXTEP } from \"../definitions/outputDefinitionsEP\";\r\nimport { formatMoney, formatMoney2, cleanFormat } from \"../utils/helper\";\r\nimport { getOutputValues } from \"../data/dataExchange\";\r\n\r\nimport {\r\n  PDF,\r\n  InToPt,\r\n  PxToPt,\r\n  HELVETICA,\r\n  TIMES,\r\n  NORMAL,\r\n  BOLD,\r\n  HEADER_RECT_IN_W,\r\n} from \"./PDF\";\r\nimport {\r\n  ASSET_TAX_TYPE_PRINCIPAL_RES,\r\n  ASSET_TAX_TYPE_REAL_ESTATE,\r\n  ASSET_TAX_TYPE_STOCKS,\r\n  ASSET_TAX_TYPE_SMALL_BUS,\r\n  ASSET_TAX_TYPE_RRSP,\r\n  ASSET_TAX_TYPE_INTEREST,\r\n  ASSET_TAX_TYPE_OTHER,\r\n  ASSET_TAX_TYPE_COUNT,\r\n} from \"../definitions/outputDefinitionsEP\";\r\n\r\nconst DISPLAY_INCOME = 1;\r\n\r\nconst BULLET_FONT_SIZE = 24;\r\nconst NUMBER_BULLET_FONT_SIZE = 11;\r\nconst GRID_AGGREGATE = 0;\r\nconst GRID_INDIVIDUAL = 1;\r\n\r\nconst LINES_PER_PAGE_LANDSCAPE = 27;\r\nconst LINES_PER_PAGE_PORTRAIT = 37;\r\n\r\nexport function doSavePdfActionEP(props, AssetLiabProjs) {\r\n  try {\r\n    let pdf = new PDF();\r\n    pdf.Create();\r\n\r\n    var paragraph;\r\n    let height = 0.2;\r\n    let Widths = [1.2, 0.6, 1.8, 1.4];\r\n    let values;\r\n    const paraWidth = 6;\r\n    const paraLeft = 1.2;\r\n    const lineHeight = 0.196;\r\n    const indent = 0.15;\r\n    let paraY = 8 * lineHeight;\r\n\r\n    // pdf output shared with presentation\r\n    let output = getOutputValues(props);\r\n\r\n    const lang = props.dataInput.Presentations[0].language;\r\n    const pg1TitleY = 4.2;\r\n\r\n   \r\n    pdf.SetFont(HELVETICA, NORMAL);\r\n    if (lang === \"en\") pdf.SetFontSize(PxToPt(36));\r\n    else pdf.SetFontSize(PxToPt(36));\r\n    pdf.SetTextColor(0x45, 0x55, 0x60);\r\n    pdf.Text(\r\n      props.INAOption === DISPLAY_INCOME\r\n        ? TITLES[lang].appletINA\r\n        : TITLES[lang].appletEP,\r\n      InToPt(paraLeft),\r\n      InToPt(pg1TitleY)\r\n    );\r\n    /* page 1: Cover page */\r\n\r\n    //pdf.addCustomImage(\"AdvisorLogo\", pg1TitleY, image, true);\r\n    const image = props.dataInput.Presentations[0].adviserLogo;\r\n    const headerOffset = image.image === null ? 0 : 0.25;\r\n    const top = props.dataInput.Presentations[0].adviserLogo.top;\r\n\r\n    let result;\r\n    result = pdf.addCustomImage(IMAGE_LOGO, pg1TitleY, image, true, top);\r\n\r\n    pdf.AddImage(\r\n      IMAGE_APPLET_EP,\r\n      InToPt(paraLeft + 0.01),\r\n      InToPt(pg1TitleY + 0.5),\r\n      InToPt(6.04),\r\n      InToPt(2.76)\r\n    );\r\n\r\n    pdf.SetFontSize(PxToPt(18));\r\n    pdf.SetTextColor(0x45, 0x55, 0x60);\r\n    pdf.Text(\r\n      OUTPUTTEXTEP[lang].pg1P1 + output.designedFor,\r\n      InToPt(paraLeft + 0.02),\r\n      InToPt(pg1TitleY + 3.63)\r\n    );\r\n    pdf.Text(\r\n      OUTPUTTEXTEP[lang].pg1P2 + output.designedBy,\r\n      InToPt(paraLeft + 0.02),\r\n      InToPt(pg1TitleY + 4.13)\r\n    );\r\n    pdf.Text(\r\n      OUTPUTTEXTEP[lang].pg1P3 + output.dateApplet,\r\n      InToPt(paraLeft + 0.02),\r\n      InToPt(pg1TitleY + 4.42)\r\n    );\r\n    pdf.Text(\r\n      OUTPUTTEXTEP[lang].pg1P4 + output.province,\r\n      InToPt(paraLeft + 0.02),\r\n      InToPt(pg1TitleY + 4.69)\r\n    );\r\n\r\n    {\r\n      /*end ofPage 1*/\r\n      const footerText = OUTPUTTEXTEP[lang].pgFooter;\r\n      const headerText = OUTPUTTEXTEP[lang].pg1T;\r\n      pdf.addFooterAndHeader(headerOffset, footerText, headerText);\r\n\r\n      /*-Introduction\t\t// Page 2*/\r\n      // logo if asked for\r\n      //    pdf.addCustomImage(\"EPOtherPagesLogo\", pg1TitleY, image);\r\n      result =\r\n        result &&\r\n        pdf.addCustomImage(IMAGE_LOGO_OTHERPAGES, pg1TitleY, image, false, top);\r\n\r\n      setFontForTitle(pdf, lang);\r\n      pdf.Text(OUTPUTTEXTEP[lang].pg2T, InToPt(paraLeft), InToPt(paraY));\r\n      setFontForParas(pdf);\r\n\r\n      let parag = [];\r\n      OUTPUTTEXTEP[lang].pg2Paragraphs.map((item) => parag.push(item));\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      insertPara(pdf, parag[0], paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 5 * lineHeight;\r\n      insertPara(pdf, parag[1], paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + (lang === \"en\" ? 4.5 : 5.5) * lineHeight;\r\n      insertBullet(pdf, \".\", paraLeft + indent, paraY, BULLET_FONT_SIZE);\r\n      insertPara(pdf, parag[2], paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 1.2 * lineHeight;\r\n      insertBullet(pdf, \".\", paraLeft + indent, paraY, BULLET_FONT_SIZE);\r\n      insertPara(pdf, parag[3], paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      insertPara(pdf, parag[4], paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 3 * lineHeight;\r\n      insertBullet(pdf, \".\", paraLeft + indent, paraY, BULLET_FONT_SIZE);\r\n      insertPara(pdf, parag[5], paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 1.2 * lineHeight;\r\n      insertBullet(pdf, \".\", paraLeft + indent, paraY, BULLET_FONT_SIZE);\r\n      insertPara(pdf, parag[6], paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 3 * lineHeight;\r\n      insertPara(pdf, parag[7], paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 3 * lineHeight;\r\n      insertBullet(pdf, \".\", paraLeft + indent, paraY, BULLET_FONT_SIZE);\r\n      insertPara(pdf, parag[8], paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 1.2 * lineHeight;\r\n      insertBullet(pdf, \".\", paraLeft + indent, paraY, BULLET_FONT_SIZE);\r\n      insertPara(pdf, parag[9], paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 1.2 * lineHeight;\r\n      insertBullet(pdf, \".\", paraLeft + indent, paraY, BULLET_FONT_SIZE);\r\n      insertPara(pdf, parag[10], paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      /*end ofPage 2*/\r\n      pdf.addFooterAndHeader(headerOffset, footerText, headerText);\r\n\r\n      /*/*-Your FEPncial Situation\t\t// Page 3*/\r\n      // logo if asked for\r\n      //    pdf.addCustomImage(\"EPOtherPagesLogo\", pg1TitleY, image);\r\n      result =\r\n        result &&\r\n        pdf.addCustomImage(IMAGE_LOGO_OTHERPAGES, pg1TitleY, image, false, top);\r\n\r\n      paraY = 8 * lineHeight;\r\n      setFontForTitle(pdf, lang);\r\n      pdf.Text(OUTPUTTEXTEP[lang].pg3T, InToPt(paraLeft), InToPt(paraY));\r\n      setFontForParas(pdf);\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      paragraph = OUTPUTTEXTEP[lang].pg3P1;\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      // assets table\r\n      let tableWidthAss =\r\n        lang === \"fr\" ? paraWidth / 2 + 0.3 : paraWidth / 2 - 0.2;\r\n      let totalAssets = 0;\r\n      height = 0.24;\r\n      Widths = [paraWidth / 4 + 0.4, paraWidth / 4 - 0.6];\r\n      if (lang === \"fr\")\r\n        Widths = [(3 * tableWidthAss) / 4 + 0.1, tableWidthAss / 4 - 0.1];\r\n\r\n      paraY = paraY + 3.2 * lineHeight;\r\n      const tmpY = paraY;\r\n      values = [OUTPUTTEXTEP[lang].pg3TabT];\r\n\r\n      let align = [];\r\n      insertTableTitle(pdf, paraLeft, paraY, values, height, [\r\n        tableWidthAss + 0.01,\r\n      ]);\r\n\r\n      output.assets.map((element) => {\r\n        values = [\r\n          element.name +\r\n            (element.name === ASSETS.OTHER_ASSETS.value[lang] &&\r\n            element.value > 0\r\n              ? \" *\"\r\n              : \"\"),\r\n          formatMoney2(element.value, 0, lang),\r\n        ];\r\n        //   console.log(values)\r\n        align.push(0);\r\n        align.push(2);\r\n        totalAssets += parseFloat(element.value);\r\n        paraY = paraY + height;\r\n        insertTableRow(\r\n          pdf,\r\n          paraLeft,\r\n          paraY,\r\n          values,\r\n          height,\r\n          Widths,\r\n          false,\r\n          [249, 249, 249],\r\n          align\r\n        );\r\n      });\r\n\r\n      align = [];\r\n      align.push(2);\r\n      align.push(2);\r\n      paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        paraLeft,\r\n        paraY,\r\n        [OUTPUTTEXTEP[lang].pg3Tab2RTot, formatMoney2(totalAssets, 0, lang)],\r\n        height,\r\n        Widths,\r\n        true,\r\n        [235, 235, 235],\r\n        align\r\n      );\r\n      // other assets footnote\r\n\r\n      if (output.otherAssetsList !== \"\") {\r\n        paraY = paraY + 2.2 * lineHeight;\r\n        paragraph = output.otherAssetsList;\r\n        addNote(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n      }\r\n      setFontForParas(pdf);\r\n      //\r\n\r\n      // liabs table\r\n      let tableWidth =\r\n        lang === \"fr\" ? paraWidth / 2 - 0.05 : paraWidth / 2 - 0.2;\r\n      Widths = [paraWidth / 4 + 0.4, paraWidth / 4 - 0.6];\r\n      if (lang === \"fr\") Widths = [(3 * tableWidth) / 4, tableWidth / 4];\r\n\r\n      let totalLiabs = 0;\r\n      const tableLeft = paraLeft + tableWidthAss + 0.2;\r\n      paraY = tmpY;\r\n      values = [OUTPUTTEXTEP[lang].pg3Tab2T];\r\n      insertTableTitle(pdf, tableLeft, paraY, values, height, [\r\n        tableWidth + 0.01,\r\n      ]);\r\n\r\n      align = [];\r\n      output.liabilities.map((element) => {\r\n        values = [element.name, formatMoney2(element.value, 0, lang)];\r\n        align.push(0);\r\n        align.push(2);\r\n\r\n        totalLiabs += parseFloat(element.value);\r\n        paraY = paraY + height;\r\n        insertTableRow(\r\n          pdf,\r\n          tableLeft,\r\n          paraY,\r\n          values,\r\n          height,\r\n          Widths,\r\n          false,\r\n          [249, 249, 249],\r\n          align\r\n        );\r\n      });\r\n\r\n      align = [];\r\n      align.push(2);\r\n      align.push(2);\r\n\r\n      paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        tableLeft,\r\n        paraY,\r\n        [OUTPUTTEXTEP[lang].pg3Tab2RTot, formatMoney2(totalLiabs, 0, lang)],\r\n        height,\r\n        Widths,\r\n        true,\r\n        [235, 235, 235],\r\n        align\r\n      );\r\n      paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        tableLeft,\r\n        paraY,\r\n        [\r\n          OUTPUTTEXTEP[lang].pg3Tab2NW,\r\n          formatMoney2(totalAssets - totalLiabs, 0, lang),\r\n        ],\r\n        height,\r\n        Widths,\r\n        true,\r\n        [205, 205, 205],\r\n        align\r\n      );\r\n\r\n      //Your growing tax liab\r\n      paraY = paraY + 4.6 * lineHeight;\r\n      setFontForTitle(pdf, lang);\r\n      pdf.Text(OUTPUTTEXTEP[lang].pg3T2, InToPt(paraLeft), InToPt(paraY));\r\n      setFontForParas(pdf);\r\n      //\r\n      paraY = paraY + 2 * lineHeight;\r\n      paragraph = OUTPUTTEXTEP[lang].pg3P2;\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      tableWidth = paraWidth;\r\n      Widths = [\r\n        tableWidth / 4 + 0.4,\r\n        tableWidth / 4 - 0.5,\r\n        tableWidth / 4 - 0.1,\r\n        tableWidth / 4 + 0.12,\r\n      ];\r\n      if (lang === \"fr\")\r\n        Widths = [\r\n          tableWidth / 4 + 0.85,\r\n          tableWidth / 4 - 0.45,\r\n          tableWidth / 4 - 0.25,\r\n          tableWidth / 4 + 0.25,\r\n        ];\r\n\r\n      paraY = paraY + (lang === \"fr\" ? 3.2 : 2.8) * lineHeight;\r\n      values = [\r\n        OUTPUTTEXTEP[lang].pg3Tab3R1C1,\r\n        OUTPUTTEXTEP[lang].pg3Tab3R1C2,\r\n        OUTPUTTEXTEP[lang].pg3Tab3R1C3,\r\n        OUTPUTTEXTEP[lang].pg3Tab3R1C4,\r\n      ];\r\n      const height2 = insertTableTitle(\r\n        pdf,\r\n        paraLeft,\r\n        paraY,\r\n        values,\r\n        height,\r\n        Widths\r\n      );\r\n      paraY = paraY + height + height2;\r\n      //paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        paraLeft,\r\n        paraY,\r\n        [\r\n          OUTPUTTEXTEP[lang].pg3Tab3R2C1,\r\n          AssetLiabProjs.EstateLiabsByTypeGrowth[ASSET_TAX_TYPE_REAL_ESTATE],\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_REAL_ESTATE],\r\n            0,\r\n            lang\r\n          ),\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_REAL_ESTATE],\r\n            0,\r\n            lang\r\n          ),\r\n        ],\r\n        height,\r\n        Widths,\r\n        false,\r\n        [249, 249, 249],\r\n        align\r\n      );\r\n      paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        paraLeft,\r\n        paraY,\r\n        [\r\n          OUTPUTTEXTEP[lang].pg3Tab3R3C1,\r\n          AssetLiabProjs.EstateLiabsByTypeGrowth[ASSET_TAX_TYPE_STOCKS],\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_STOCKS],\r\n            0,\r\n            lang\r\n          ),\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_STOCKS],\r\n            0,\r\n            lang\r\n          ),\r\n        ],\r\n\r\n        height,\r\n        Widths,\r\n        false,\r\n        [249, 249, 249],\r\n        align\r\n      );\r\n      paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        paraLeft,\r\n        paraY,\r\n        [\r\n          OUTPUTTEXTEP[lang].pg3Tab3R4C1,\r\n          AssetLiabProjs.EstateLiabsByTypeGrowth[ASSET_TAX_TYPE_SMALL_BUS],\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_SMALL_BUS],\r\n            0,\r\n            lang\r\n          ),\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_SMALL_BUS],\r\n            0,\r\n            lang\r\n          ),\r\n        ],\r\n\r\n        height,\r\n        Widths,\r\n        false,\r\n        [249, 249, 249],\r\n        align\r\n      );\r\n      paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        paraLeft,\r\n        paraY,\r\n        [\r\n          OUTPUTTEXTEP[lang].pg3Tab3R5C1,\r\n          AssetLiabProjs.EstateLiabsByTypeGrowth[ASSET_TAX_TYPE_RRSP],\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_RRSP],\r\n            0,\r\n            lang\r\n          ),\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_RRSP],\r\n            0,\r\n            lang\r\n          ),\r\n        ],\r\n        height,\r\n        Widths,\r\n        false,\r\n        [249, 249, 249],\r\n        align\r\n      );\r\n      paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        paraLeft,\r\n        paraY,\r\n        [\r\n          OUTPUTTEXTEP[lang].pg3Tab3R6C1,\r\n          AssetLiabProjs.EstateLiabsByTypeGrowth[ASSET_TAX_TYPE_INTEREST],\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_INTEREST],\r\n            0,\r\n            lang\r\n          ),\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_INTEREST],\r\n            0,\r\n            lang\r\n          ),\r\n        ],\r\n        height,\r\n        Widths,\r\n        false,\r\n        [249, 249, 249],\r\n        align\r\n      );\r\n      paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        paraLeft,\r\n        paraY,\r\n        [\r\n          OUTPUTTEXTEP[lang].pg3Tab3R7C1,\r\n          AssetLiabProjs.EstateLiabsByTypeGrowth[ASSET_TAX_TYPE_OTHER],\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_OTHER],\r\n            0,\r\n            lang\r\n          ),\r\n          formatMoney2(\r\n            AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_OTHER],\r\n            0,\r\n            lang\r\n          ),\r\n        ],\r\n        height,\r\n        Widths,\r\n        false,\r\n        [249, 249, 249],\r\n        align\r\n      );\r\n\r\n      Widths = [\r\n        tableWidth / 4 + (lang === \"fr\" ? 0.6 : 0.1) + tableWidth / 4 - 0.2,\r\n        tableWidth / 4 - (lang === \"fr\" ? 0.25 : 0.1),\r\n        tableWidth / 4 + (lang === \"fr\" ? 0.25 : 0.12),\r\n      ];\r\n      paraY = paraY + height;\r\n      insertTableRow(\r\n        pdf,\r\n        paraLeft,\r\n        paraY,\r\n        [\r\n          OUTPUTTEXTEP[lang].pg3Tab3R8C1,\r\n          formatMoney2(AssetLiabProjs.EstateLiabsByTypeTotal, 0, lang),\r\n          formatMoney2(AssetLiabProjs.EstateLiabsByTypeLE3Total, 0, lang),\r\n        ],\r\n        height,\r\n        Widths,\r\n        true,\r\n        [235, 235, 235],\r\n        align\r\n      );\r\n\r\n      paraY = paraY + 2.2 * lineHeight;\r\n      paragraph = OUTPUTTEXTEP[lang].pg3P4;\r\n      addNote(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n      paraY = paraY + (lang === \"fr\" ? 1.7 : 0.8) * lineHeight;\r\n      paragraph = OUTPUTTEXTEP[lang].pg3P5;\r\n      addNote(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      /*end ofPage 3*/\r\n      pdf.addFooterAndHeader(headerOffset, footerText, headerText);\r\n      /*/*-Future value of estate\t\t// Page 4*/\r\n      // logo if asked for\r\n      //pdf.addCustomImage(\"EPOtherPagesLogo\", pg1TitleY, image);\r\n      result =\r\n        result &&\r\n        pdf.addCustomImage(IMAGE_LOGO_OTHERPAGES, pg1TitleY, image, false, top);\r\n\r\n      paraY = 8 * lineHeight;\r\n      setFontForTitle(pdf, lang);\r\n      pdf.Text(OUTPUTTEXTEP[lang].pg4T, InToPt(paraLeft), InToPt(paraY));\r\n      setFontForParas(pdf);\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      paragraph = OUTPUTTEXTEP[lang].pg4P1;\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 4.7 * lineHeight;\r\n      pdf.AddChart(\r\n        \"stackedChart\",\r\n        InToPt(paraLeft),\r\n        InToPt(paraY),\r\n        InToPt(paraWidth),\r\n        InToPt(20 * lineHeight)\r\n      );\r\n\r\n      paraY = paraY + 20.5 * lineHeight;\r\n      paragraph = OUTPUTTEXTEP[lang].pg4P2 + props.LE + \")\";\r\n      addNote(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 3.7 * lineHeight;\r\n      paragraph = OUTPUTTEXTEP[lang].pg4P3\r\n        .replace(\r\n          \"X1\",\r\n          formatMoney2(AssetLiabProjs.EstateLiabsByTypeTotal, 0, lang)\r\n        )\r\n        .replace(\r\n          \"X2\",\r\n          formatMoney2(AssetLiabProjs.EstateLiabsByTypeLE3Total, 0, lang)\r\n        );\r\n      pdf.drawRect(paraLeft, paraY - 0.3, paraWidth + 0.4, 3 * height, [\r\n        235,\r\n        235,\r\n        235,\r\n      ]);\r\n      insertPara(pdf, paragraph, paraLeft + 0.2, paraY, paraWidth);\r\n\r\n      paraY = paraY + 3 * lineHeight;\r\n      pdf.AddChart(\r\n        \"pieEstateLeakage\",\r\n        InToPt(paraLeft - 0.7),\r\n        InToPt(paraY),\r\n        InToPt(0.75 * paraWidth),\r\n        InToPt((43 * paraWidth) / 120)\r\n      );\r\n      // paraY = paraY + 5*lineHeight;\r\n      pdf.AddChart(\r\n        \"pieEstateLeakage2\",\r\n        InToPt(paraLeft + 0.48 * paraWidth),\r\n        InToPt(paraY),\r\n        InToPt(0.75 * paraWidth),\r\n        InToPt((43 * paraWidth) / 120)\r\n      );\r\n\r\n      /*end ofPage 4*/\r\n      pdf.addFooterAndHeader(headerOffset, footerText, headerText);\r\n\r\n      /*/*-Estate Protection Alternatives\t\t// Page 5*/\r\n      // logo if asked for\r\n      //    pdf.addCustomImage(\"EPOtherPagesLogo\", pg1TitleY, image);\r\n      result =\r\n        result &&\r\n        pdf.addCustomImage(IMAGE_LOGO_OTHERPAGES, pg1TitleY, image, false, top);\r\n\r\n      paraY = 8 * lineHeight;\r\n      setFontForTitle(pdf, lang);\r\n      pdf.Text(OUTPUTTEXTEP[lang].pg5T, InToPt(paraLeft), InToPt(paraY));\r\n      setFontForParas(pdf);\r\n\r\n      parag = [];\r\n      OUTPUTTEXTEP[lang].pg5Paragraphs.map((item) => parag.push(item));\r\n      //console.log(parag);\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      paragraph = parag[0];\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 4 * lineHeight;\r\n      paragraph = parag[1];\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 2.5 * lineHeight;\r\n      paragraph = parag[2];\r\n      insertBullet(\r\n        pdf,\r\n        \"1.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 1.5 * lineHeight;\r\n      paragraph = parag[3];\r\n      insertBullet(\r\n        pdf,\r\n        \"2.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 1.5 * lineHeight;\r\n      paragraph = parag[4];\r\n      insertBullet(\r\n        pdf,\r\n        \"3.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + (lang === \"fr\" ? 2.5 : 1.5) * lineHeight;\r\n      paragraph = parag[5];\r\n      insertBullet(\r\n        pdf,\r\n        \"4.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      paragraph = parag[6];\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 1.5 * lineHeight;\r\n      paragraph = parag[7];\r\n      insertBullet(\r\n        pdf,\r\n        \"1.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 5 * lineHeight;\r\n      paragraph = parag[8];\r\n      insertBullet(\r\n        pdf,\r\n        \"2.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 6 * lineHeight;\r\n      paragraph = parag[9];\r\n      insertBullet(\r\n        pdf,\r\n        \"3.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 4 * lineHeight;\r\n      paragraph = parag[10];\r\n      insertBullet(\r\n        pdf,\r\n        \"4.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 6 * lineHeight;\r\n      paragraph = OUTPUTTEXTEP[lang].pg5Plast;\r\n\r\n      //this.setDrawColor(235, 235, 235);\r\n      pdf.drawRect(paraLeft, paraY - 0.3, paraWidth + 0.4, 3 * height, [\r\n        235,\r\n        235,\r\n        235,\r\n      ]);\r\n      insertPara(pdf, paragraph, paraLeft + 0.2, paraY, paraWidth);\r\n\r\n      /*end ofPage 5*/\r\n      pdf.addFooterAndHeader(headerOffset, footerText, headerText);\r\n\r\n      /*/*-Using Life Insurance to Preserve Your Estate\t\t// Page 6*/\r\n      // logo if asked for\r\n      //    pdf.addCustomImage(\"EPOtherPagesLogo\", pg1TitleY, image);\r\n      result =\r\n        result &&\r\n        pdf.addCustomImage(IMAGE_LOGO_OTHERPAGES, pg1TitleY, image, false, top);\r\n\r\n      paraY = 8 * lineHeight;\r\n      setFontForTitle(pdf, lang);\r\n      pdf.Text(OUTPUTTEXTEP[lang].pg6T, InToPt(paraLeft), InToPt(paraY));\r\n      setFontForParas(pdf);\r\n\r\n      parag = [];\r\n      OUTPUTTEXTEP[lang].pg6Paragraphs1.map((item) => parag.push(item));\r\n      //console.log(parag);\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      paragraph = parag[0];\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 5 * lineHeight;\r\n      paragraph = parag[1];\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 3.5 * lineHeight;\r\n      paragraph = parag[2];\r\n      insertBullet(\r\n        pdf,\r\n        \"1.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 1.4 * lineHeight;\r\n      paragraph = parag[3];\r\n      insertBullet(\r\n        pdf,\r\n        \"2.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 1.4 * lineHeight;\r\n      paragraph = parag[4];\r\n      insertBullet(\r\n        pdf,\r\n        \"3.\",\r\n        paraLeft + indent,\r\n        paraY,\r\n        NUMBER_BULLET_FONT_SIZE\r\n      );\r\n      insertPara(pdf, paragraph, paraLeft + 2.3 * indent, paraY, paraWidth);\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      paragraph = parag[5];\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      paraY = paraY + 6 * lineHeight;\r\n      paragraph = parag[6];\r\n      insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n      // reduced after edit\r\n      /*   paraY = paraY + 4 * lineHeight;\r\n    paragraph = parag[7];\r\n    insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n    paraY = paraY + 4 * lineHeight;\r\n    paragraph = parag[8];\r\n    insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n    paraY = paraY + 3 * lineHeight;\r\n    paragraph = parag[9];\r\n    insertPara(pdf, paragraph, paraLeft, paraY, paraWidth); */\r\n\r\n      /*end ofPage 6*/\r\n      //    addFooterAndHeader(pdf, lang);\r\n\r\n      // combine summary page with last\r\n\r\n      /*/*-Summary\t\t// Page 7*/\r\n      // paraY = 8 * lineHeight;\r\n      // logo if asked for\r\n      //    pdf.addCustomImage(\"EPOtherPagesLogo\", pg1TitleY, image);\r\n      result =\r\n        result &&\r\n        pdf.addCustomImage(IMAGE_LOGO_OTHERPAGES, pg1TitleY, image, false, top);\r\n\r\n      paraY = paraY + 8 * lineHeight;\r\n      setFontForTitle(pdf, lang);\r\n      pdf.Text(OUTPUTTEXTEP[lang].pg7T, InToPt(paraLeft), InToPt(paraY));\r\n      setFontForParas(pdf);\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      paragraph = OUTPUTTEXTEP[lang].pg7P1;\r\n      pdf.MultilineText(\r\n        paragraph,\r\n        InToPt(paraLeft),\r\n        InToPt(paraY),\r\n        InToPt(paraWidth)\r\n      );\r\n\r\n      /*end ofPage 7*/\r\n      pdf.Footer(OUTPUTTEXTEP[lang].pgFooter);\r\n\r\n      /*/*-Appendix\t\tgrids // Page 8*/\r\n\r\n      // add a landscape page for aggregate grid\r\n\r\n      const LE = props.LE; //- props.assetProjections[0].grid.dataProjection[1][0];\r\n      const offsetLE=4;\r\n      insertGrid2(\r\n        pdf,\r\n        props.aggregateGrid,\r\n        LE,\r\n        paraLeft - 0.2,\r\n        1.65 * paraWidth,\r\n        lang,\r\n        true,\r\n        \"landscape\",\r\n        0,\r\n        GRID_AGGREGATE\r\n      );\r\n      // if too long add another page\r\n      if (\r\n        LE + offsetLE > LINES_PER_PAGE_LANDSCAPE &&\r\n        LE + offsetLE < 2 * LINES_PER_PAGE_LANDSCAPE\r\n      )\r\n        insertGrid2(\r\n          pdf,\r\n          props.aggregateGrid,\r\n          LE,\r\n          paraLeft - 0.2,\r\n          1.65 * paraWidth,\r\n          lang,\r\n          true,\r\n          \"landscape\",\r\n          LINES_PER_PAGE_LANDSCAPE,\r\n          GRID_AGGREGATE\r\n        );\r\n      else if (LE + offsetLE > 2 * LINES_PER_PAGE_LANDSCAPE) {\r\n        insertGrid2(\r\n          pdf,\r\n          props.aggregateGrid,\r\n          LE,\r\n          paraLeft - 0.2,\r\n          1.65 * paraWidth,\r\n          lang,\r\n          true,\r\n          \"landscape\",\r\n          LINES_PER_PAGE_LANDSCAPE,\r\n          GRID_AGGREGATE\r\n        );\r\n        insertGrid2(\r\n          pdf,\r\n          props.aggregateGrid,\r\n          LE,\r\n          paraLeft - 0.2,\r\n          1.65 * paraWidth,\r\n          lang,\r\n          true,\r\n          \"landscape\",\r\n          2 * LINES_PER_PAGE_LANDSCAPE,\r\n          GRID_AGGREGATE\r\n        );\r\n      }\r\n      for (let j = 0; j < props.assetProjections.length; ++j)\r\n        insertGrid2(\r\n          pdf,\r\n          props.assetProjections[j].grid,\r\n          LE,\r\n          paraLeft,\r\n          paraWidth,\r\n          lang,\r\n          true,\r\n          \"portrait\",\r\n          0,\r\n          GRID_INDIVIDUAL\r\n        );\r\n\r\n      /*end ofPage 8*/\r\n      pdf.addFooterAndHeader(headerOffset, footerText, headerText);\r\n\r\n      /*/*-Using Life Insurance to Preserve Your Estate\t\t// Page 6*/\r\n      // logo if asked for\r\n      //    pdf.addCustomImage(\"EPOtherPagesLogo\", pg1TitleY, image);\r\n      result =\r\n        result &&\r\n        pdf.addCustomImage(IMAGE_LOGO_OTHERPAGES, pg1TitleY, image, false, top);\r\n\r\n      paraY = 8 * lineHeight;\r\n      setFontForTitle(pdf, lang);\r\n      pdf.Text(OUTPUTTEXTEP[lang].pg9T, InToPt(paraLeft), InToPt(paraY));\r\n      setFontForParas(pdf);\r\n\r\n      paraY = paraY + 2 * lineHeight;\r\n      insertPara(pdf, OUTPUTTEXTEP[lang].pg9P1, paraLeft, paraY, paraWidth);\r\n      paraY = paraY + (lang === \"fr\" ? 7 : 6) * lineHeight;\r\n      insertPara(pdf, OUTPUTTEXTEP[lang].pg9P2, paraLeft, paraY, paraWidth);\r\n\r\n      //pdf.Footer(OUTPUTTEXTEP[lang].pgFooter);\r\n      // pdf.showOnPage();\r\n      var data = pdf.showOnPage();\r\n\r\n      if (result === false) alert(lang===\"en\"?\"PDF image error\":\"Erreur d’image PDF\");\r\n\r\n      // Done\r\n      pdf.Save(\"PYE_PDF.pdf\");\r\n      return data;\r\n    }\r\n  } catch (error) {}\r\n}\r\n\r\nfunction setFontForTitle(pdf, lang, size) {\r\n  pdf.SetFont(HELVETICA, NORMAL);\r\n  if (size === undefined) {\r\n    if (lang === \"en\") pdf.SetFontSize(PxToPt(25));\r\n    else pdf.SetFontSize(PxToPt(20));\r\n  } else {\r\n    pdf.SetFont(HELVETICA, BOLD);\r\n    if (lang === \"en\") pdf.SetFontSize(PxToPt(size));\r\n    else pdf.SetFontSize(PxToPt(size - 1));\r\n  }\r\n\r\n  pdf.SetTextColor(0x45, 0x55, 0x60);\r\n}\r\n\r\nfunction addNote(pdf, para, left, paraY, paraWidth) {\r\n  setFontForParas(pdf);\r\n  pdf.SetTextColor(150, 150, 150);\r\n  pdf.SetFontSize(PxToPt(12));\r\n  insertPara(pdf, para, left, paraY, paraWidth);\r\n  setFontForParas(pdf);\r\n}\r\n\r\nfunction setFontForParas(pdf) {\r\n  pdf.SetFont(TIMES, NORMAL);\r\n  pdf.SetFontSize(PxToPt(16));\r\n  pdf.SetTextColor(0x45, 0x55, 0x60);\r\n}\r\n\r\nfunction insertBullet(pdf, bullet, left, y, size) {\r\n  pdf.SetTextColor(115, 153, 198);\r\n  pdf.SetFontSize(PxToPt(size));\r\n  pdf.SetFont(TIMES, BOLD);\r\n  pdf.Text(\r\n    bullet,\r\n    InToPt(left + (size === BULLET_FONT_SIZE ? 0.02 : 0)),\r\n    InToPt(y - (size === BULLET_FONT_SIZE ? 0.03 : 0))\r\n  );\r\n  pdf.SetFont(TIMES, NORMAL);\r\n  pdf.SetFontSize(PxToPt(16));\r\n  pdf.SetTextColor(0x45, 0x55, 0x60);\r\n}\r\n\r\nfunction insertPara(pdf, para, left, paraY, paraWidth) {\r\n  pdf.MultilineText(para, InToPt(left), InToPt(paraY), InToPt(paraWidth));\r\n}\r\n\r\nfunction insertTableTitle(\r\n  pdf,\r\n  paraLeft,\r\n  paraY,\r\n  values,\r\n  height,\r\n  paraWidths,\r\n  fillColor\r\n) {\r\n  pdf.SetFontSize(PxToPt(12));\r\n  const fill = fillColor === undefined ? [115, 153, 198] : fillColor;\r\n  const textColor = [255, 255, 255];\r\n  pdf.SetFont(TIMES, BOLD);\r\n  const h = pdf.tableRow(\r\n    fill,\r\n    textColor,\r\n    paraLeft,\r\n    paraY,\r\n    values,\r\n    height,\r\n    paraWidths,\r\n    false,\r\n    false,\r\n    true\r\n  );\r\n  return h;\r\n}\r\n\r\nfunction insertTableRow(\r\n  pdf,\r\n  paraLeft,\r\n  paraY,\r\n  values,\r\n  height,\r\n  paraWidths,\r\n  bold,\r\n  fillColor,\r\n  align\r\n) {\r\n  pdf.SetTextColor(0x45, 0x55, 0x60);\r\n  const fill = fillColor === undefined ? [249, 249, 249] : fillColor;\r\n  const textColor = [0x45, 0x55, 0x60];\r\n  pdf.SetFont(TIMES, bold ? BOLD : NORMAL);\r\n  pdf.tableRow(\r\n    fill,\r\n    textColor,\r\n    paraLeft,\r\n    paraY,\r\n    values,\r\n    height,\r\n    paraWidths,\r\n    true,\r\n    align\r\n  );\r\n}\r\n/* function insertTableRowBold(pdf, paraLeft, paraY, values, height, paraWidths,align) {\r\n  pdf.SetTextColor(0x45, 0x55, 0x60);\r\n  const fill = [235, 235, 235];\r\n  const textColor = [0x45, 0x55, 0x60];\r\n  pdf.SetFont(TIMES, BOLD);\r\n  pdf.tableRow(\r\n    fill,\r\n    textColor,\r\n    paraLeft,\r\n    paraY,\r\n    values,\r\n    height,\r\n    paraWidths,\r\n    true,\r\n    align\r\n  );\r\n}\r\n */\r\n\r\n/* function pdf.addCustomImage( id,pg1TitleY,image,firstPage){\r\n \r\npdf.AddImageFitWidthOnly(\r\n  id,\r\n  InToPt(pg1TitleY - 3 + image.left*HEADER_RECT_IN_W/100), //1.51),\r\n  InToPt(firstPage?1.06:.29),\r\n  InToPt(6.04*image.size/100),\r\n  InToPt(firstPage?2.76:.38) // max height\r\n);\r\n} */\r\n\r\nfunction insertGrid2(\r\n  pdf,\r\n  grid,\r\n  LE,\r\n  paraLeft,\r\n  paraWidth,\r\n  lang,\r\n  wrappedTitleBar,\r\n  orientation,\r\n  startYr,\r\n  mode\r\n) {\r\n  let i;\r\n  let j;\r\n  let cols = grid.dataColTitles.length;\r\n  const height = 0.2;\r\n  let paraY = 2.2 * height;\r\n  let max =\r\n    orientation === \"landscape\"\r\n      ? startYr === 0\r\n        ? LINES_PER_PAGE_LANDSCAPE\r\n        : 2 * LINES_PER_PAGE_LANDSCAPE\r\n      : LINES_PER_PAGE_PORTRAIT;\r\n  const decimalChar = lang === \"en\" ? \".\" : \",\";\r\n  const thousands = lang === \"en\" ? \",\" : \" \";\r\n  //const formatFr = lang === \"fr\" ? true : false;\r\n  let Widths = [];\r\n\r\n  pdf.AddPage(orientation);\r\n\r\n  // Appendix title\r\n  setFontForTitle(pdf, lang, 16);\r\n  let paragraph = OUTPUTTEXTEP[lang].pg8T + \": \" + OUTPUTTEXTEP[lang].pg3T;\r\n  insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n  // Appendix para\r\n  setFontForParas(pdf);\r\n  paraY = paraY + 1.6 * height;\r\n  paragraph =\r\n    (mode === GRID_AGGREGATE\r\n      ? OUTPUTTEXTEP[lang].pg8P1\r\n      : OUTPUTTEXTEP[lang].pg8P2) +\r\n    (mode === GRID_AGGREGATE ? (startYr === 0 ? \"\" : \"\") : \"\");\r\n  insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n\r\n  paraY = paraY + 0.5 * height;\r\n\r\n  // grid name and title\r\n  // grid col widths\r\n  Widths.push(paraWidth / (cols + 5)); // year\r\n  Widths.push(paraWidth / (cols + 5)); // age\r\n  for (i = 2; i < cols; ++i) {\r\n    Widths.push((paraWidth - (2 * paraWidth) / (cols + 4)) / (cols - 2));\r\n  }\r\n\r\n  \r\n  // max of 8 columns in portrait\r\n  let totalGridWidth = paraWidth;\r\n  if (mode === GRID_INDIVIDUAL) totalGridWidth = (cols * paraWidth) / 8;\r\n\r\n  let values = grid.dataColTitles;\r\n  let goodWidth = [];\r\n  let totalGoodWidth = 0;\r\n  for (i = 0; i < cols; ++i) {\r\n    goodWidth.push(pdf.textWidth(values[i]));\r\n    totalGoodWidth += goodWidth[i];\r\n  }\r\n  // aportion grid title\r\n  for (i = 0; i < cols; ++i) {\r\n    Widths[i] =goodWidth[i] + 0.15;\r\n    if(Widths[i]>2.1*Widths[0])Widths[i]=2.1*Widths[0]\r\n  }\r\n\r\n  \r\n  let widthTotal = 0;\r\n  for (i = 2; i < cols; ++i) widthTotal += Widths[i];\r\n\r\n  // now check multilines\r\n  let goodWidthMultiLine = [];\r\n  let totalGoodWidthMultiLine = 0;\r\n\r\n  let addMore =\r\n    (totalGridWidth - widthTotal - Widths[0] - Widths[1]) / (cols - 2);\r\n  if (mode === GRID_INDIVIDUAL) {\r\n    if(cols<8)\r\n      for (i = 2; i < cols; ++i) Widths[i] += addMore;\r\n  } else if (mode === GRID_AGGREGATE) {\r\n    addMore =\r\n      (totalGridWidth - widthTotal - Widths[0] - Widths[1]) / (cols - 3);\r\n    for (i = 2; i < cols; ++i) if (i !== 4) Widths[i] += addMore;\r\n  }\r\n\r\n  \r\n\r\n  for (i = 0; i < cols; ++i) {\r\n    goodWidthMultiLine.push(pdf.textWidthMultiLine(values[i], Widths[i]));\r\n    totalGoodWidthMultiLine += goodWidthMultiLine[i];\r\n  }\r\n  // aportion grid title\r\n\r\n  /*  for (i = 0; i < cols; ++i)\r\n    if(Widths[i]<.9*goodWidthMultiLine[i])\r\n        Widths[i]=goodWidthMultiLine[i]/.9\r\n */\r\n  //for (i = 0; i < cols; ++i)\r\n  //console.log(values[i],goodWidth[i],goodWidthMultiLine[i],Widths[i])\r\n  // for (i = 0; i < cols; ++i)\r\n  //  Widths[i]=goodWidthMultiLine[i]/.9*totalGridWidth/totalGoodWidthMultiLine\r\n\r\n  // if(mode===GRID_AGGREGATE)\r\n  {\r\n    paraY = paraY + 0.8 * height;\r\n    paragraph = grid.gridTitle;\r\n    pdf.SetFontSize(PxToPt(12));\r\n    pdf.SetTextColor(0x45, 0x55, 0x60);\r\n    insertPara(pdf, paragraph, paraLeft, paraY, paraWidth);\r\n    paraY = paraY + 0.4 * height;\r\n  }\r\n\r\n  // headers\r\n  //console.log(values)\r\n  const height2 = insertTableTitle(\r\n    pdf,\r\n    paraLeft,\r\n    paraY,\r\n    values,\r\n    height,\r\n    Widths,\r\n    [51, 77, 124]\r\n  );\r\n\r\n  // grid rows\r\n  let rows = startYr;\r\n  let fillColor;\r\n  if (wrappedTitleBar) paraY = paraY + height2;\r\n  // 40 rows per page\r\n  const offsetLE=4\r\n \r\n  while (rows < LE + offsetLE) {\r\n    //grid.dataProjection[0].length) {\r\n\r\n    if (\r\n      rows === max &&\r\n      ((startYr === 0 && LE + offsetLE - rows > 2) ||\r\n        (startYr === LINES_PER_PAGE_LANDSCAPE &&\r\n          LE + LINES_PER_PAGE_LANDSCAPE + offsetLE - rows > 2))\r\n    ) {\r\n      if (mode === GRID_AGGREGATE) {\r\n        insertPara(\r\n          pdf,\r\n          \"\",\r\n          paraLeft,\r\n          paraY + (3 * height) / 2 + 0.1,\r\n          paraWidth\r\n        );\r\n        pdf.FooterLandscape(OUTPUTTEXTEP[lang].pgFooter);\r\n        return rows;\r\n      }\r\n\r\n      rows = LE + offsetLE - 2;\r\n      paraY = paraY + height;\r\n      pdf.SetFont(TIMES, BOLD);\r\n      insertPara(pdf, \"......\", paraLeft, paraY + height / 2, paraWidth);\r\n      pdf.SetFont(TIMES, NORMAL);\r\n    }\r\n    values = [];\r\n\r\n    let align = [];\r\n    for (i = 0; i < cols; ++i) {\r\n      //if(i===0) console.log(grid.dataProjection[i][rows])\r\n      values.push(\r\n        (i === 0 && rows === 0) || i === 1 || i === 11\r\n          ? String(grid.dataProjection[i][rows])\r\n          : formatMoney(\r\n              parseFloat(cleanFormat(grid.dataProjection[i][rows], lang)),\r\n              0,\r\n              decimalChar,\r\n              thousands\r\n            ).toString()\r\n      );\r\n      align.push(2);\r\n    }\r\n    paraY = paraY + height;\r\n    fillColor = rows % 2 ? [249, 249, 249] : [228, 229, 230];\r\n    if (rows == LE) {\r\n      fillColor = [208, 215, 230];\r\n      insertPara(\r\n        pdf,\r\n        lang === \"en\" ? \"LE\" : \"EV\",\r\n        paraLeft + totalGridWidth + 0.15,\r\n        paraY + height / 2 + 0.01,\r\n        paraWidth\r\n      );\r\n    }\r\n    //console.log(values)\r\n    insertTableRow(\r\n      pdf,\r\n      paraLeft,\r\n      paraY,\r\n      values,\r\n      height,\r\n      Widths,\r\n      false,\r\n      fillColor,\r\n      align\r\n    );\r\n\r\n    rows++;\r\n  }\r\n\r\n  if (orientation === \"landscape\")\r\n    pdf.FooterLandscape(OUTPUTTEXTEP[lang].pgFooter);\r\n  else pdf.Footer(OUTPUTTEXTEP[lang].pgFooter);\r\n}","import React from \"react\";\r\nimport { Chart,Bar, Pie } from \"react-chartjs-2\";\r\n//import ChartDataLabels from 'chartjs-plugin-datalabels';\r\n//import \"./Output.css\";\r\nimport \"./Output.css\";\r\nimport { setUIDataToAPI } from \"../data/dataExchange\";\r\nimport { getAssetLiabProjections } from \"../data/aggregateGridProjections\";\r\nimport {\r\n  getProjectedLiabilities,\r\n  getLeakageGraphs\r\n} from \"../utils/helper\";\r\nimport {\r\n  QUOTE_CLIENT,\r\n  QUOTE_SPOUSE,\r\n} from \"../definitions/generalDefinitions\";\r\nimport { OUTPUTTEXTEP } from \"../definitions/outputDefinitionsEP\";\r\n\r\n// for Estate\r\nconst DISPLAY_TAXLIAB_CLIENT = 1;\r\nconst DISPLAY_TAXLIAB_JLTD = 2;\r\n\r\nexport class OutputGraphsEPLeakage extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n   // Chart.plugins.unregister(ChartDataLabels)\r\n  }\r\n  \r\n  render() {\r\n    // get data similar to presentation\r\n  \r\n    const AssetLiabProjs = getAssetLiabProjections(this.props);\r\n    const lang =this.props.dataInput.Presentations[0].language;\r\n    const totalLiabProjections = getProjectedLiabilities(\r\n      this.props.dataInput,\r\n      this.props.projectEnd,\r\n      this.props.probate\r\n    );\r\n\r\n    let dtaAgesAll = [];\r\n    let k;\r\n    let lifeExp = this.props.lifeExp;\r\n    const clients = this.props.dataInput.Clients;\r\n    let age =\r\n      clients.length > 1\r\n        ? Math.min(clients[QUOTE_SPOUSE].Age, clients[QUOTE_CLIENT].Age)\r\n        : clients[QUOTE_CLIENT].Age;\r\n\r\n    //let age = this.props.dataInput.Clients[1].Age;\r\n\r\n    if (this.INAEstateOption === DISPLAY_TAXLIAB_CLIENT) {\r\n      lifeExp = this.props.lifeExpClient;\r\n      age = this.props.dataInput.Clients[QUOTE_CLIENT].Age;\r\n    } else if (this.INAEstateOption === DISPLAY_TAXLIAB_JLTD) {\r\n      lifeExp = this.props.lifeExpJLTD;\r\n      age =\r\n        clients.length > 1\r\n          ? Math.min(clients[QUOTE_SPOUSE].Age, clients[QUOTE_CLIENT].Age)\r\n          : clients[QUOTE_CLIENT].Age;\r\n    }\r\n\r\n    for (k = 0; k <= lifeExp + 3; ++k) {\r\n      dtaAgesAll.push(age + k);\r\n    }\r\n\r\n  const leakageGraps=getLeakageGraphs(this.props.dataInput.Assets,this.props.assetProjections,AssetLiabProjs,totalLiabProjections,\r\n  lang,\r\n  lifeExp)\r\n\r\n\r\n\r\n // leakageGraps.dataPieEstateLeakage.plugins=[ChartDataLabels]\r\n // leakageGraps.dataPieEstateLeakageLE.plugins=[ChartDataLabels]\r\n\r\n leakageGraps.optionsPieEstateLeakage.legend.labels.boxWidth = 20;\r\n leakageGraps.optionsPieEstateLeakageLE.legend.labels.boxWidth = 20;\r\n //optionsPieEstateLeakageLE.legend.labels.position = \"left\";\r\n //leakageGraps.dataPieEstateLeakage.responsive=false\r\n //leakageGraps.dataPieEstateLeakage.maintainAspectRatio=false\r\n  //leakageGraps.optionsPieEstateLeakage.legend.position= \"bottom\"\r\n  //leakageGraps.optionsPieEstateLeakageLE.legend.position= \"bottom\"\r\n \r\nreturn (\r\n  <div style={{ width: \"90%\" }}>\r\n    <div style={{ width: \"100%\" }}>\r\n\r\n        <h3 className=\"ppi1\">\r\n        <div>\r\n          {OUTPUTTEXTEP[lang].graphsLeakageT1} <br />\r\n        </div>\r\n      </h3>\r\n        \r\n        <div style={{ width: \"90%\" }}>\r\n        <article  id=\"pieEstateLeakage\"\r\n            className=\"canvas-containerLeakage\">\r\n            <div className=\"EPGraphDiv\">\r\n            <Pie\r\n              data={leakageGraps.dataPieEstateLeakage}\r\n              options={leakageGraps.optionsPieEstateLeakage}\r\n            />\r\n          </div >\r\n          </article>\r\n        <article  id=\"pieEstateLeakage2\"\r\n            className=\"canvas-containerLeakage\" >\r\n            <div className=\"EPGraphDiv\">\r\n            <Pie\r\n              data={leakageGraps.dataPieEstateLeakageLE}\r\n              options={leakageGraps.optionsPieEstateLeakageLE}\r\n            />\r\n          </div>\r\n        </article>\r\n        </div>\r\n        \r\n\r\n      <br />\r\n      <hr />\r\n    </div>\r\n  </div>\r\n);\r\n\r\n}\r\n\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Pie, Bar, Line, Chart } from \"react-chartjs-2\";\r\nimport \"./Output.css\";\r\nimport { OUTPUTTEXTEP } from \"../definitions/outputDefinitionsEP\";\r\n\r\nimport { TOTALS } from \"../definitions/generalDefinitions\";\r\nexport class OutputGraphStacked extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  render() {\r\n    const lang = this.props.language;\r\n    var optionsEstate = {\r\n      /*  \"hover\": {\r\n        \"animationDuration\": 0\r\n      },\r\n      \"animation\": {\r\n        \"duration\": 1,\r\n        \"onComplete\": function() {\r\n          var chartInstance = this.chart,\r\n            ctx = chartInstance.ctx;\r\n  \r\n          ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);\r\n          ctx.textAlign = 'center';\r\n          ctx.textBaseline = 'bottom';\r\n  \r\n          this.data.datasets.forEach(function(dataset, i) {\r\n            var meta = chartInstance.controller.getDatasetMeta(i);\r\n            meta.data.forEach(function(bar, index) {\r\n              var data = dataset.data[index];\r\n              ctx.fillText(data, bar._model.x, bar._model.y - 5);\r\n            });\r\n          });\r\n        }\r\n      }, */\r\n      elements: { point: { radius: 0 } },\r\n      responsive: true,\r\n      title: {\r\n        display: true,\r\n        position: \"top\",\r\n        text: OUTPUTTEXTEP[lang].pg4GT,\r\n        fontSize: 14, //8,\r\n        fontColor: \"#111\",\r\n      },\r\n      legend: {\r\n        display: true,\r\n        position: \"bottom\",\r\n        labels: {\r\n          fontColor: \"#333\",\r\n          fontSize: 12, //16\r\n        },\r\n      },\r\n      scales: {\r\n        yAxes: [\r\n          {\r\n            stacked: true,\r\n            ticks: {\r\n              beginAtZero: true,\r\n              callback: function (value, index, values) {\r\n                let result =\r\n                  value < 1000\r\n                    ? value\r\n                    : lang === \"en\"\r\n                    ? Intl.NumberFormat().format(value / 1000) + \"K\"\r\n                    : (Intl.NumberFormat().format(value / 1000) + \"K\").replace(\r\n                        \",\",\r\n                        \" \"\r\n                      );\r\n                return result;\r\n              },\r\n            },\r\n          },\r\n        ],\r\n        xAxes: [\r\n          {\r\n            stacked: true,\r\n            ticks: {\r\n              beginAtZero: true,\r\n            },\r\n          },\r\n        ],\r\n      },\r\n    };\r\n\r\n    let dataAssetnEstateLiabProj = [];\r\n\r\n    let type = [\"line\", \"bar\"];\r\n\r\n    let col = [];\r\n\r\n    // Estate Liability has to be first to stay on top!\r\n    let data = [];\r\n    const taxLiab = TOTALS.TAX_LIAB.value[this.props.language];\r\n    for (let i = 0; i < this.props.dataAssetnEstateLiabProj.length; ++i) {\r\n      if (this.props.dataAssetnEstateLiabProj[i].name === taxLiab)\r\n        data.push(this.props.dataAssetnEstateLiabProj[i]);\r\n    }\r\n    for (let i = 0; i < this.props.dataAssetnEstateLiabProj.length; ++i) {\r\n      if (this.props.dataAssetnEstateLiabProj[i].name !== taxLiab)\r\n        data.push(this.props.dataAssetnEstateLiabProj[i]);\r\n    }\r\n\r\n    for (let i = 0; i < data.length; ++i) {\r\n      col = [];\r\n      let taxLiabLine = data[i].name === taxLiab ? true : false;\r\n      for (let k = 0; k < this.props.dataAges.length; ++k) {\r\n        col.push(data[i].colour);\r\n      }\r\n      col[this.props.LE] = shadeColor(data[i].colour, -20);\r\n      dataAssetnEstateLiabProj.push({\r\n        type: type[taxLiabLine ? 0 : 1],\r\n        label: data[i].name,\r\n        data: data[i].values, //!== undefined?this.props.dataRE:[],\r\n        fill: taxLiabLine ? false : true,\r\n        borderColor: data[i].colour,\r\n        backgroundColor: col, //this.props.dataAssetnEstateLiabProj[i].colour\r\n      });\r\n    }\r\n\r\n    \r\n\r\n    function shadeColor(color, percent) {\r\n      var R = parseInt(color.substring(1, 3), 16);\r\n      var G = parseInt(color.substring(3, 5), 16);\r\n      var B = parseInt(color.substring(5, 7), 16);\r\n\r\n      R = parseInt((R * (100 + percent)) / 100);\r\n      G = parseInt((G * (100 + percent)) / 100);\r\n      B = parseInt((B * (100 + percent)) / 100);\r\n\r\n      R = R < 255 ? R : 255;\r\n      G = G < 255 ? G : 255;\r\n      B = B < 255 ? B : 255;\r\n\r\n      var RR =\r\n        R.toString(16).length == 1 ? \"0\" + R.toString(16) : R.toString(16);\r\n      var GG =\r\n        G.toString(16).length == 1 ? \"0\" + G.toString(16) : G.toString(16);\r\n      var BB =\r\n        B.toString(16).length == 1 ? \"0\" + B.toString(16) : B.toString(16);\r\n\r\n      return \"#\" + RR + GG + BB;\r\n    }\r\n\r\n    const dataEstate = {\r\n      labels: this.props.dataAges, // this.dataAges,\r\n      datasets: dataAssetnEstateLiabProj,\r\n    };\r\n\r\n    return (\r\n      <div style={{ width: \"90%\" }}>\r\n        <div>\r\n          <article\r\n            id=\"stackedChart\"\r\n            className=\"canvas-containerWeb\"\r\n            style={{ marginLeft: \"25px\", height: \"450px\" }}\r\n          >\r\n            <div\r\n              style={{\r\n                overflow: \"hidden\",\r\n                float: \"left\",\r\n                width: \"100%\",\r\n                height: \"400px\",\r\n              }}\r\n            >\r\n              <Bar data={dataEstate} options={optionsEstate} />\r\n            </div>\r\n          </article>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport \"./Output.css\";\r\nimport { Table } from \"react-bootstrap\";\r\nimport {\r\n  ASSETS,\r\n  ASSET_TAX,\r\n  CONTROLTITLE,\r\n  TOTALS,\r\n  TITLES,\r\n  QUOTE_SPOUSE,\r\n  QUOTE_CLIENT,\r\n  OUTPUT_WIDTH_PCT,\r\n} from \"../definitions/generalDefinitions\";\r\nimport { OUTPUTTEXTEP } from \"../definitions/outputDefinitionsEP\";\r\n//import { Bar } from \"react-chartjs-2\";\r\nimport { doSavePdfActionEP } from \"./OutputPDFEP\";\r\nimport { MultiButtons } from \"./MultiButtons\";\r\nimport { OutputGraphsEPLeakage } from \"./OutputGraphsEPLeakage\";\r\nimport {getLogoAndAppletImage,getAgesEP} from \"../utils/helper\";\r\nimport { getInfoExportINA  } from \"../definitions/infoIconsDefinitions\";\r\nimport { Info } from \"./Info\";\r\n\r\n//import { AdjustibleImage } from \"./AdjustibleImage\";\r\n//import jsPDF from 'jspdf';\r\n//import * as jsPDF from 'jspdf';\r\nimport {\r\n  formatMoney,\r\n  formatMoney2,\r\n  getListItemNameFromKey,\r\n  getProjectedLiabilities,\r\n} from \"../utils/helper\";\r\nimport { getOutputValues, setUIDataToAPI } from \"../data/dataExchange\";\r\nimport { getAssetLiabProjections } from \"../data/aggregateGridProjections\";\r\nimport { OutputGraphStacked } from \"./OutputGraphStacked\";\r\nimport {\r\n  fetchAssetProjectionAPI,\r\n  fetchAssetProjection,\r\n  fetchAssetFMVandTaxLiab,\r\n} from \"../utils/FetchAPIs\";\r\n\r\nimport { getAssetGridValues } from \"../data/assetGridProjections\";\r\nimport DataTable from \"./GridExcelComponent/DataTable\";\r\n//import { isEqual } from \"lodash\";\r\nimport Loader from \"react-loader-spinner\";\r\nimport { AddToHomeScreenOutlined } from \"@material-ui/icons\";\r\n\r\nimport {\r\n  ASSET_TAX_TYPE_PRINCIPAL_RES,\r\n  ASSET_TAX_TYPE_REAL_ESTATE,\r\n  ASSET_TAX_TYPE_STOCKS,\r\n  ASSET_TAX_TYPE_SMALL_BUS,\r\n  ASSET_TAX_TYPE_RRSP,\r\n  ASSET_TAX_TYPE_INTEREST,\r\n  ASSET_TAX_TYPE_OTHER,\r\n  ASSET_TAX_TYPE_COUNT,\r\n} from \"../definitions/outputDefinitionsEP\";\r\n\r\nexport default class OutputPresentationEP extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loading: true,\r\n      showGrids: false,\r\n      image: this.props.dataInput.Presentations[0].adviserLogo.image,\r\n      imageSize: 90,\r\n      imageAlign: 2,\r\n    };\r\n    this.AssetLiabProjs = null;\r\n  }\r\n\r\n\r\n  doINA = async () => {\r\n    //window.top.location.href = 'localhost:8086';\r\n    //window.parent.changeLogo();\r\n   // console.log(this.props);\r\n    /* console.log(\"INA_\" +\r\n    this.props.dataInput.Presentations[0].language +\r\n    \"_\" +\r\n    this.props.encryptedInput,\r\n  \"*\") */\r\n   await window.parent.postMessage(\r\n      \"INA_\" +\r\n        this.props.dataInput.Presentations[0].language +\r\n        \"_\" +\r\n        this.props.encryptedInputLife1AndSpouse,\r\n      \"*\"\r\n    );\r\n\r\n   \r\n  };\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    this.setState({ showGrids: false });\r\n  }\r\n\r\n  clickMultiButton = (e) => {\r\n    let showGrids = true;\r\n    if (e === 1) showGrids = false;\r\n\r\n    this.setState({ showGrids: showGrids });\r\n  };\r\n\r\n  doPDF = () => {\r\n    var data = doSavePdfActionEP(this.props, this.AssetLiabProjs); //, this.dateApplet);\r\n\r\n    // option to embed the pdf\r\n    /* {\r\n      setTimeout(function () {\r\n        document.getElementById(\"obj\").setAttribute(\"data\", data);\r\n        document.getElementById(\"obj\").setAttribute(\"height\", \"0px\");\r\n      }, 1000);\r\n    } */\r\n  };\r\n\r\n  doPrint = () => {\r\n    var mywindow = window.open(\"\", \"PRINT\");\r\n\r\n    mywindow.document.write(\r\n      \"<html><head><title>\" + document.title + \"</title>\"\r\n    );\r\n    mywindow.document.write(\"</head><body >\");\r\n    mywindow.document.write(\"<h1>\" + \"Protecting Your Estate\" + \"</h1>\");\r\n    mywindow.document.write(document.getElementById(\"presentation\").innerHTML);\r\n    mywindow.document.write(\"</body></html>\");\r\n\r\n    mywindow.document.close(); // necessary for IE >= 10\r\n    mywindow.focus(); // necessary for IE >= 10*/\r\n\r\n    mywindow.print();\r\n    mywindow.close();\r\n\r\n    return true;\r\n  };\r\n\r\n  /*  onImageChange = (event) => {\r\n    if (event.target.files && event.target.files[0]) {\r\n      this.setState({\r\n        image: URL.createObjectURL(event.target.files[0])\r\n      });\r\n    }\r\n   } */\r\n\r\n  render() {\r\n    this.AssetLiabProjs = getAssetLiabProjections(this.props);\r\n    \r\n    this.output = getOutputValues(this.props);\r\n    const styleWithLogo = { overflow: \"hidden\", width: \"100%\", overflowX: \"auto\" };\r\n    const styleWithLogoGrids = {width: \"100%\" };\r\n    \r\n    const lang = this.props.dataInput.Presentations[0].language;\r\n    const LE = this.props.LE;\r\n    const clients = this.props.dataInput.Clients;\r\n\r\n    let loaded =\r\n      this.AssetLiabProjs.AssetnEstateLiabs.length > 0 ? true : false;\r\n\r\n    \r\n  \r\n    //let dataAges = [];\r\n\r\n    const startAge =\r\n      clients.length > 1\r\n        ? Math.min(clients[QUOTE_SPOUSE].Age, clients[QUOTE_CLIENT].Age)\r\n        : clients[QUOTE_CLIENT].Age;\r\n    // do to LE+3\r\n\r\n\r\n    let dataAges=getAgesEP (clients, LE)\r\n    \r\n\r\n    let p2 = 1;\r\n    let p5 = 1;\r\n    let p6 = 1;\r\n   \r\n    //const { grids, loading } = this.state;\r\n    let totalAssets = 0;\r\n    let totalLiabs = 0;\r\n    if (this.AssetLiabProjs.projectionsGrids[0] === undefined) {\r\n      return <div class=\"loader-container\"><div class=\"loader\"></div></div> //<div><Loader type=\"TailSpin\" color=\"black\" height={30} width={30} /></div>\r\n    }\r\n\r\n\r\n    const allPages =\r\n      this.props.dataInput.Presentations[0].adviserLogo.image !== null &&\r\n      this.props.dataInput.Presentations[0].adviserLogo.allPages;\r\n\r\n    let j = 0;\r\n\r\n    const images=getLogoAndAppletImage(this.props.dataInput, this.props.imageRemove,this.props.imageAdjust)\r\n    const logoTop=images.logoTop\r\n    const logoBottom=images.logoBottom\r\n   \r\n\r\n    return (\r\n      <div id=\"presentation\">\r\n        <input\r\n          className=\"roundedCornerCmd\"\r\n          style={{\r\n            //width: \"90px\",\r\n            marginTop: \"-32px\",\r\n                marginRight: \"0px\",\r\n                paddingRight: \"8px\",\r\n                float: \"right\",\r\n          }}\r\n          onClick={this.doPDF}\r\n          type=\"button\"\r\n          value={CONTROLTITLE[lang].pdf}\r\n        />\r\n        <div style={{ width: \"100%\", float: \"left\", clear: \"left\" }}>\r\n\r\n      \r\n\r\n            <input\r\n              className=\"roundedCornerCmd\"\r\n              style={{\r\n           //     width: \"180px\",\r\n                marginTop: \"25px\",\r\n                marginRight: \"0px\",\r\n                paddingRight: \"8px\",\r\n                float: \"right\",\r\n              }}\r\n              onClick={this.doINA}\r\n              type=\"button\"\r\n              value={TITLES[lang].appletINA}\r\n            />{<div style={{\r\n                 paddingTop: \"10px\",\r\n                 float: \"right\",\r\n               }}><Info infoIcon={getInfoExportINA(lang)}/></div>} \r\n          </div>\r\n        {/* <object id=\"obj\" type=\"application/pdf\" width=\"50%\" height=\"0px\">\r\n          <p>\r\n            It appears you don't have a PDF plugin for this browser. Please\r\n            download the PDF file.\r\n          </p>\r\n        </object> */}\r\n\r\n        {/* \r\n<iframe id='iframe' type=\"application/pdf\" style={{width:\"100%\", height:\"auto\", float:\"left\"}}></iframe>\r\n        <input\r\n          className=\"multiButtons multiButtonsAct\"\r\n          style={{\r\n            width: \"90px\",\r\n            marginTop: \"0px\",\r\n            paddingRight: \"8px\",\r\n            float: \"right\",\r\n          }}\r\n          onClick={this.doPDF2}\r\n          type=\"button\"\r\n          value={CONTROLTITLE[lang].pdf}\r\n        />\r\n */}\r\n        {/*  <input\r\n          className=\"multiButtons multiButtonsAct\"\r\n          style={{\r\n            width: \"130px\",\r\n            marginTop: \"0px\",\r\n            paddingRight: \"8px\",\r\n            float: \"right\",\r\n          }}\r\n          onClick={this.doPrint}\r\n          type=\"button\"\r\n          value={CONTROLTITLE[lang].print}\r\n        />\r\n */}\r\n        {/* <h3 className=\"ppi1\">\r\n          {needTo}: {this.props.insuranceNeed}\r\n        </h3>\r\n */}\r\n\r\n        <div className=\"contentPres\">\r\n          {/* PAGE 1 */}\r\n\r\n          <p />\r\n        {/* add logo */}\r\n          {images.logo1stPage}\r\n            {/* add image */}\r\n            {images.applet}\r\n\r\n{/*           {this.props.dataInput.Presentations[0].adviserLogo.image !== null && (\r\n            <AdjustibleImage\r\n              image={this.props.dataInput.Presentations[0].adviserLogo.image}\r\n              showDetails={\r\n                this.props.dataInput.Presentations[0].adviserLogo.showDetails\r\n              }\r\n              size={this.props.dataInput.Presentations[0].adviserLogo.size}\r\n              imageLeft={this.props.dataInput.Presentations[0].adviserLogo.left}\r\n              allPages={\r\n                this.props.dataInput.Presentations[0].adviserLogo.allPages\r\n              }\r\n              imageRemove={this.props.imageRemove}\r\n              imageAdjust={this.props.imageAdjust}\r\n              ID={\"AdvisorLogo\"}\r\n            />\r\n          )}\r\n          <AdjustibleImage\r\n            image={require(\"../images/estate.protection.applet.cover.graphic.png\")}\r\n            showDetails={false}\r\n            size={OUTPUT_WIDTH_PCT}\r\n            imageLeft={0}\r\n            ID={\"EPPage1\"}\r\n          />\r\n */}          {/*            <img\r\n            className=\"ppi1\"\r\n            id=\"EPPage1\"\r\n            src={require(\"../images/estate.protection.applet.cover.graphic.png\")}\r\n            width=\"90%\"\r\n          />  */}\r\n          <h1 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg1T}</h1>\r\n          <h5 className=\"ppi2\">\r\n            {OUTPUTTEXTEP[lang].pg1P1} {this.output.designedFor}\r\n            <br />\r\n            {OUTPUTTEXTEP[lang].pg1P2} {this.output.designedBy}\r\n            <br />\r\n            {OUTPUTTEXTEP[lang].pg1P3} {this.output.dateApplet}\r\n            <br />\r\n            {OUTPUTTEXTEP[lang].pg1P4} {this.output.province}\r\n            <br />\r\n          </h5>\r\n          <hr className=\"ppi1\" />\r\n          \r\n          {logoBottom}\r\n          {/* PAGE 2 Intro*/}\r\n\r\n          <div style={styleWithLogo}>\r\n          {logoTop}\r\n            {/* {allPages && (\r\n              <AdjustibleImage\r\n                image={this.props.dataInput.Presentations[0].adviserLogo.image}\r\n                showDetails={false}\r\n                size={this.props.dataInput.Presentations[0].adviserLogo.size}\r\n                imageLeft={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.left\r\n                }\r\n                allPages={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.allPages\r\n                }\r\n                imageRemove={this.props.imageRemove}\r\n                imageAdjust={this.props.imageAdjust}\r\n                ID={\"EPOtherPagesLogo\"}\r\n              />\r\n            )} */}\r\n            <br />\r\n            <h2 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg2T}</h2>\r\n            {/* number changed to bullets feek */}\r\n            {OUTPUTTEXTEP[lang].pg2Paragraphs.map((item) => (\r\n              <p className=\"ppi1\" key={p2++}>\r\n                {p2 >= 4 && p2 !== 6 && p2 !== 9 && p2 <= 12 && (\r\n                  <span\r\n                    style={{\r\n                      paddingLeft: \"15px\",\r\n                      paddingRight: \"5px\",\r\n                      color: \"#759AC7\",\r\n                      fontSize: \"18px\",\r\n                      whiteSpace: \"nowrap\",\r\n                    }}\r\n                  >\r\n                    {/*{p2 < 6 ? p2 - 3 : p2 < 9 ? p2 - 4 : p2 - 5}.{\" \"}*/}\r\n                    &#8226;\r\n                  </span>\r\n                )}{\" \"}\r\n                {item}\r\n                <br />\r\n              </p>\r\n            ))}\r\n          </div>\r\n\r\n          {/* PAGE 3 fin situation*/}\r\n          {logoBottom}\r\n          \r\n          <div style={styleWithLogo}>\r\n          {logoTop}\r\n            {/* {allPages && (\r\n              <AdjustibleImage\r\n                image={this.props.dataInput.Presentations[0].adviserLogo.image}\r\n                showDetails={false}\r\n                size={this.props.dataInput.Presentations[0].adviserLogo.size}\r\n                imageLeft={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.left\r\n                }\r\n                allPages={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.allPages\r\n                }\r\n                imageRemove={this.props.imageRemove}\r\n                imageAdjust={this.props.imageAdjust}\r\n              />\r\n            )} */}\r\n            <br />\r\n            <h2 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg3T}</h2>\r\n            <p className=\"ppi1\">{OUTPUTTEXTEP[lang].pg3P1}</p>\r\n\r\n            <div style={{ fontSize: \"14px\" }}>\r\n              <div style={{ paddingLeft: \"20px\", width: \"35%\", float: \"left\" }}>\r\n                <div>\r\n                  <table\r\n                    className=\"tableEP\"\r\n                    style={{ paddingLeft: \"10px\", width: \"100%\" }}\r\n                  >\r\n                    <tbody>\r\n                      <tr>\r\n                        <th className=\"tableTitleEP\" colSpan=\"2\">\r\n                          {OUTPUTTEXTEP[lang].pg3TabT}\r\n                        </th>\r\n                      </tr>\r\n                      {/* add assets*/}\r\n                      {this.output.assets.map((item) => {\r\n                        totalAssets += item.value;\r\n                        return (\r\n                          <tr key={item.name}>\r\n                            <td style={{ height: \"1px\", width: \"65%\" }}>\r\n                              {item.name}\r\n                              {item.name === ASSETS.OTHER_ASSETS.value[lang] &&\r\n                              item.value > 0\r\n                                ? \" *\"\r\n                                : \"\"}\r\n                            </td>\r\n                            <td\r\n                              className=\"textalignright\"\r\n                              style={{ height: \"1px\" }}\r\n                            >\r\n                              {/* ${formatMoney(item.value, 0, \",\", \",\")} */}\r\n                              {formatMoney2(item.value, 0, lang)}\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      })}\r\n                      <tr\r\n                        key={\"totalAssets\"}\r\n                        style={{\r\n                          height: \"1px\",\r\n                          width: \"65%\",\r\n                          backgroundColor: \"#f0f0f5\",\r\n                          textAlign: \"right\",\r\n                        }}\r\n                      >\r\n                        <td>{OUTPUTTEXTEP[lang].pg3Tab2RTot}</td>\r\n                        <td\r\n                          className=\"textalignright\"\r\n                          style={{ height: \"1px\" }}\r\n                        >\r\n                          {/* ${formatMoney(totalAssets, 0, \",\", \",\")} */}\r\n                          {formatMoney2(totalAssets, 0, lang)}\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                  {this.output.otherAssetsList !== \"\" && (\r\n                    <p\r\n                      className=\"ppi1\"\r\n                      style={{\r\n                        color: \"darkgrey\",\r\n                        marginTop: \"3px\",\r\n                        marginLeft: \"-10px\",\r\n                        fontSize: \"12px\",\r\n                        float: \"left\",\r\n                      }}\r\n                    >\r\n                      {this.output.otherAssetsList}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div style={{ paddingLeft: \"23px\", width: \"38%\", float: \"left\" }}>\r\n                <div>\r\n                  <table\r\n                    className=\"tableEP\"\r\n                    style={{ paddingLeft: \"10px\", width: \"100%\" }}\r\n                  >\r\n                    <tbody>\r\n                      <tr>\r\n                        <th className=\"tableTitleEP\" colSpan=\"2\">\r\n                          {OUTPUTTEXTEP[lang].pg3Tab2T}\r\n                        </th>\r\n                      </tr>\r\n                      {/* liabs*/}\r\n                      {this.output.liabilities.map((item) => {\r\n                        totalLiabs += item.value;\r\n                        return (\r\n                          <tr key={item.name}>\r\n                            <td style={{ width: \"60%\" }}>{item.name}</td>\r\n                            <td className=\"textalignright\">\r\n                              {/* ${formatMoney(item.value, 0, \",\", \",\")} */}\r\n                              {formatMoney2(item.value, 0, lang)}\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      })}\r\n                      <tr\r\n                        key={\"totalLiabs\"}\r\n                        style={{\r\n                          height: \"1px\",\r\n                          width: \"65%\",\r\n                          backgroundColor: \"#f0f0f5\",\r\n                          textAlign: \"right\",\r\n                        }}\r\n                      >\r\n                        <td>{OUTPUTTEXTEP[lang].pg3Tab2RTot}</td>\r\n                        <td\r\n                          className=\"textalignright\"\r\n                          style={{ height: \"1px\" }}\r\n                        >\r\n                          {/* ${formatMoney(totalLiabs, 0, \",\", \",\")} */}\r\n                          {formatMoney2(totalLiabs, 0, lang)}\r\n                        </td>\r\n                      </tr>\r\n                      <tr\r\n                        key={\"netWorth\"}\r\n                        style={{\r\n                          height: \"1px\",\r\n                          width: \"65%\",\r\n                          backgroundColor: \"#d1d1e0\",\r\n                          textAlign: \"right\",\r\n                        }}\r\n                      >\r\n                        <td>{OUTPUTTEXTEP[lang].pg3Tab2NW}</td>\r\n                        <td\r\n                          className=\"textalignright\"\r\n                          style={{ height: \"1px\" }}\r\n                        >\r\n                          {/* ${formatMoney(totalAssets-totalLiabs, 0, \",\", \",\")} */}\r\n                          {formatMoney2(totalAssets - totalLiabs, 0, lang)}\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <h2 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg3T2}</h2>\r\n          <p className=\"ppi1\">{OUTPUTTEXTEP[lang].pg3P2}</p>\r\n          <p className=\"ppi1\">{OUTPUTTEXTEP[lang].pg3P3}</p>\r\n\r\n          <div\r\n            style={{\r\n              fontFamily: \"Georgia, 'Times New Roman', imes, serif\",\r\n              fontSize: \"14px\",\r\n            }}\r\n          >\r\n            <div style={{ paddingLeft: \"20px\", width: \"70%\", float: \"left\" }}>\r\n              <div>\r\n                <table\r\n                  className=\"tableEP\"\r\n                  style={{ paddingLeft: \"10px\", width: \"100%\" }}\r\n                >\r\n                  <tbody>\r\n                    <tr>\r\n                      <th className=\"tableTitleEP\" style={{ width: \"30%\" }}>\r\n                        {OUTPUTTEXTEP[lang].pg3Tab3R1C1}\r\n                      </th>\r\n                      <th className=\"tableTitleEP\" style={{ width: \"20%\" }}>\r\n                        {OUTPUTTEXTEP[lang].pg3Tab3R1C2}\r\n                      </th>\r\n                      <th className=\"tableTitleEP\" style={{ width: \"20%\" }}>\r\n                        {OUTPUTTEXTEP[lang].pg3Tab3R1C3}\r\n                      </th>\r\n                      <th className=\"tableTitleEP\" style={{ width: \"20%\" }}>\r\n                        {OUTPUTTEXTEP[lang].pg3Tab3R1C4}\r\n                      </th>\r\n                    </tr>\r\n                    <tr>\r\n                      <td>{OUTPUTTEXTEP[lang].pg3Tab3R2C1}</td>\r\n                      <td className=\"textalignright\">\r\n                        {\r\n                          this.AssetLiabProjs.EstateLiabsByTypeGrowth[\r\n                            ASSET_TAX_TYPE_REAL_ESTATE\r\n                          ]\r\n                        }\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_REAL_ESTATE],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByType[\r\n                            ASSET_TAX_TYPE_REAL_ESTATE\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[\r\n                            ASSET_TAX_TYPE_REAL_ESTATE\r\n                          ],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[\r\n                            ASSET_TAX_TYPE_REAL_ESTATE\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <td>{OUTPUTTEXTEP[lang].pg3Tab3R3C1}</td>\r\n                      <td className=\"textalignright\">\r\n                        {\r\n                          this.AssetLiabProjs.EstateLiabsByTypeGrowth[\r\n                            ASSET_TAX_TYPE_STOCKS\r\n                          ]\r\n                        }\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_STOCKS],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByType[\r\n                            ASSET_TAX_TYPE_STOCKS\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_STOCKS],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[\r\n                            ASSET_TAX_TYPE_STOCKS\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <td>{OUTPUTTEXTEP[lang].pg3Tab3R4C1}</td>\r\n                      <td className=\"textalignright\">\r\n                        {\r\n                          this.AssetLiabProjs.EstateLiabsByTypeGrowth[\r\n                            ASSET_TAX_TYPE_SMALL_BUS\r\n                          ]\r\n                        }\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_SMALL_BUS],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByType[\r\n                            ASSET_TAX_TYPE_SMALL_BUS\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_SMALL_BUS],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[\r\n                            ASSET_TAX_TYPE_SMALL_BUS\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <td>{OUTPUTTEXTEP[lang].pg3Tab3R5C1}</td>\r\n                      <td className=\"textalignright\">\r\n                        {\r\n                          this.AssetLiabProjs.EstateLiabsByTypeGrowth[\r\n                            ASSET_TAX_TYPE_RRSP\r\n                          ]\r\n                        }\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_RRSP],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByType[\r\n                            ASSET_TAX_TYPE_RRSP\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_RRSP],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[\r\n                            ASSET_TAX_TYPE_RRSP\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <td>{OUTPUTTEXTEP[lang].pg3Tab3R6C1}</td>\r\n                      <td className=\"textalignright\">\r\n                        {\r\n                          this.AssetLiabProjs.EstateLiabsByTypeGrowth[\r\n                            ASSET_TAX_TYPE_INTEREST\r\n                          ]\r\n                        }\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_INTEREST],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByType[\r\n                            ASSET_TAX_TYPE_INTEREST\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_INTEREST],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[\r\n                            ASSET_TAX_TYPE_INTEREST\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                    <tr>\r\n                      <td>{OUTPUTTEXTEP[lang].pg3Tab3R7C1}</td>\r\n                      <td className=\"textalignright\">\r\n                        {\r\n                          this.AssetLiabProjs.EstateLiabsByTypeGrowth[\r\n                            ASSET_TAX_TYPE_OTHER\r\n                          ]\r\n                        }\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByType[ASSET_TAX_TYPE_INTEREST],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByType[\r\n                            ASSET_TAX_TYPE_OTHER\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* $\r\n                        {formatMoney(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[ASSET_TAX_TYPE_INTEREST],\r\n                          0,\r\n                          \",\",\r\n                          \",\"\r\n                        )} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3[\r\n                            ASSET_TAX_TYPE_OTHER\r\n                          ],\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                    <tr\r\n                      style={{ backgroundColor: \"#f0f0f5\", textAlign: \"right\" }}\r\n                    >\r\n                      <td colSpan=\"2\">{OUTPUTTEXTEP[lang].pg3Tab3R8C1}</td>\r\n                      <td className=\"textalignright\">\r\n                        {/* ${formatMoney(this.AssetLiabProjs.EstateLiabsByTypeTotal, 0, \",\", \",\")} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeTotal,\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                      <td className=\"textalignright\">\r\n                        {/* ${formatMoney(this.AssetLiabProjs.EstateLiabsByTypeLE3Total, 0, \",\", \",\")} */}\r\n                        {formatMoney2(\r\n                          this.AssetLiabProjs.EstateLiabsByTypeLE3Total,\r\n                          0,\r\n                          lang\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n            <p\r\n              className=\"ppi1\"\r\n              style={{\r\n                color: \"darkgrey\",\r\n                marginTop: \"3px\",\r\n                fontSize: \"12px\",\r\n                float: \"left\",\r\n              }}\r\n            >\r\n              {OUTPUTTEXTEP[lang].pg3P4}\r\n              <br />\r\n              {OUTPUTTEXTEP[lang].pg3P5}\r\n            </p>\r\n          </div>\r\n\r\n          {logoBottom}\r\n          \r\n          {/* PAGE 4 fin situation*/}\r\n          <div style={styleWithLogo}>\r\n          {logoTop}\r\n            {/* {allPages && (\r\n              <AdjustibleImage\r\n                image={this.props.dataInput.Presentations[0].adviserLogo.image}\r\n                showDetails={false}\r\n                size={this.props.dataInput.Presentations[0].adviserLogo.size}\r\n                imageLeft={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.left\r\n                }\r\n                allPages={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.allPages\r\n                }\r\n                imageRemove={this.props.imageRemove}\r\n                imageAdjust={this.props.imageAdjust}\r\n              />\r\n            )} */}\r\n            <br />\r\n            <h2 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg4T}</h2>\r\n            <p className=\"ppi1\">{OUTPUTTEXTEP[lang].pg4P1}</p>\r\n          </div>\r\n\r\n          {\r\n            (loaded === true && (\r\n              <OutputGraphStacked\r\n                language={lang}\r\n                dataAges={dataAges}\r\n                dataAssetnEstateLiabProj={this.AssetLiabProjs.AssetnEstateLiabs}\r\n                LE={LE} //\r\n              />\r\n            ))\r\n          }\r\n\r\n          <p\r\n            className=\"ppi1\"\r\n            style={{\r\n              color: \"darkgrey\",\r\n              marginTop: \"-30px\",\r\n              fontSize: \"12px\",\r\n              float: \"left\",\r\n            }}\r\n          >\r\n            {OUTPUTTEXTEP[lang].pg4P2 + LE + \")\"}\r\n          </p>\r\n\r\n          <p\r\n            className=\"ppi1\"\r\n            style={{\r\n              backgroundColor: \"lightgrey\",\r\n              width: \"84%\",\r\n              marginTop: \"30px\",\r\n              paddingTop: \"10px\",\r\n              paddingBottom: \"12px\",\r\n              marginLeft: \"30px\",\r\n            }}\r\n          >\r\n            {OUTPUTTEXTEP[lang].pg4P3\r\n              .replace(\r\n                \"X1\",\r\n                formatMoney2(\r\n                  this.AssetLiabProjs.EstateLiabsByTypeTotal,\r\n                  0,\r\n                  lang\r\n                )\r\n              )\r\n              .replace(\r\n                \"X2\",\r\n                formatMoney2(\r\n                  this.AssetLiabProjs.EstateLiabsByTypeLE3Total,\r\n                  0,\r\n                  lang\r\n                )\r\n              )}\r\n          </p>\r\n\r\n          <div>\r\n            <OutputGraphsEPLeakage\r\n              insuranceNeed={this.props.insuranceNeed}\r\n              projectEnd={startAge + LE + 3}\r\n              dataEstateLiability={this.props.dataEstateLiability}\r\n              dataInput={this.props.dataInput}\r\n              dataNAAges={dataAges}\r\n              probate={this.props.probate}\r\n              lifeExp={LE}\r\n              lifeExpJLTD={LE}\r\n              lifeExpClient={LE}\r\n              INAOption={this.INAOption}\r\n              //dataShortfall={dataShort}\r\n              //dataAPISite={appSiteAPI}\r\n              LE={this.props.LE}\r\n              assetProjections={this.props.assetProjections}\r\n              showLeakageOnly={true}\r\n              //language={lang}\r\n              //projectTo={this.toRetirement ? 0 : 1}\r\n              //periodOption={DISPLAY_LIFEEXP_PLUS_3}\r\n            />\r\n          </div>\r\n\r\n          {logoBottom}\r\n          \r\n          {/* PAGE 5 Estate Protection Alternatives*/}\r\n\r\n          <div style={styleWithLogo}>\r\n          {logoTop}\r\n            {/* {allPages && (\r\n              <AdjustibleImage\r\n                image={this.props.dataInput.Presentations[0].adviserLogo.image}\r\n                showDetails={false}\r\n                size={this.props.dataInput.Presentations[0].adviserLogo.size}\r\n                imageLeft={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.left\r\n                }\r\n                allPages={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.allPages\r\n                }\r\n                imageRemove={this.props.imageRemove}\r\n                imageAdjust={this.props.imageAdjust}\r\n              />\r\n            )} */}\r\n            <br />\r\n            <h2 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg5T}</h2>\r\n\r\n            {OUTPUTTEXTEP[lang].pg5Paragraphs.map((item) => (\r\n              <p className=\"ppi1\" key={p5++}>\r\n                {p5 >= 4 && p5 !== 8 && p5 <= 12 && (\r\n                  <span style={{ paddingLeft: \"15px\", color: \"#759AC7\" }}>\r\n                    {p5 < 8 ? p5 - 3 : p5 - 8}.{\" \"}\r\n                  </span>\r\n                )}{\" \"}\r\n                {item}\r\n                <br />\r\n              </p>\r\n            ))}\r\n\r\n            <p\r\n              className=\"ppi1\"\r\n              style={{\r\n                backgroundColor: \"lightgrey\",\r\n                width: \"84%\",\r\n                marginTop: \"30px\",\r\n                paddingTop: \"10px\",\r\n                paddingBottom: \"12px\",\r\n                marginLeft: \"30px\",\r\n              }}\r\n            >\r\n              {OUTPUTTEXTEP[lang].pg5Plast}\r\n            </p>\r\n          </div>\r\n\r\n          {logoBottom}\r\n          \r\n          {/* PAGE 6 Using Life Insurance to Preserve Your Estate*/}\r\n\r\n          <div\r\n            style={{ overflowX: \"hidden\", overflowY: \"hidden\", width: \"100%\" }}\r\n          >\r\n            {logoTop}\r\n            {/* {allPages && (\r\n              <AdjustibleImage\r\n                image={this.props.dataInput.Presentations[0].adviserLogo.image}\r\n                showDetails={false}\r\n                size={this.props.dataInput.Presentations[0].adviserLogo.size}\r\n                imageLeft={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.left\r\n                }\r\n                allPages={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.allPages\r\n                }\r\n                imageRemove={this.props.imageRemove}\r\n                imageAdjust={this.props.imageAdjust}\r\n              />\r\n            )}\r\n */}\r\n            <br />\r\n            <h2 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg6T}</h2>\r\n            {OUTPUTTEXTEP[lang].pg6Paragraphs1.map((item) => (\r\n              <p className=\"ppi1\" key={p6++}>\r\n                {p6 >= 4 && p6 <= 6 && (\r\n                  <span style={{ paddingLeft: \"15px\", color: \"#759AC7\" }}>\r\n                    {p6 < 8 ? p6 - 3 : p6 - 8}.{\" \"}\r\n                  </span>\r\n                )}{\" \"}\r\n                {item}\r\n                <br />\r\n              </p>\r\n            ))}\r\n            {/*} don't show for now*/}\r\n            {/* {OUTPUTTEXTEP[lang].pg6Paragraphs2.map(item =>\r\n              (<p className=\"ppi1\" key={p6++}>{p6 > 12 && <span style={{ paddingLeft: '15px', color: '#759AC7' }}>&#8226;  </span>} {item}<br /></p>)\r\n            )} */}\r\n          </div>\r\n\r\n          {logoBottom}\r\n          \r\n          {/* PAGE 7 Summary*/}\r\n\r\n          <div style={styleWithLogo}>\r\n          {logoTop}\r\n            {/* {allPages && (\r\n              <AdjustibleImage\r\n                image={this.props.dataInput.Presentations[0].adviserLogo.image}\r\n                showDetails={false}\r\n                size={this.props.dataInput.Presentations[0].adviserLogo.size}\r\n                imageLeft={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.left\r\n                }\r\n                allPages={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.allPages\r\n                }\r\n                imageRemove={this.props.imageRemove}\r\n                imageAdjust={this.props.imageAdjust}\r\n              />\r\n            )} */}\r\n            <br />\r\n            <h2 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg7T}</h2>\r\n            <p className=\"ppi1\">{OUTPUTTEXTEP[lang].pg7P1}</p>\r\n          </div>\r\n\r\n          {/* PAGE 8 appendix ledgers*/}\r\n\r\n          <div style={styleWithLogoGrids}>\r\n            <br />\r\n            <h2 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg8T}</h2>\r\n\r\n            <p className=\"ppi1\">{OUTPUTTEXTEP[lang].pg8P2}</p>\r\n\r\n            <div style={{ marginLeft: \"24px\" }}>\r\n              <MultiButtons\r\n                noButtons={2}\r\n                buttonCaption={[\r\n                  OUTPUTTEXTEP[lang].pg8O1,\r\n                  OUTPUTTEXTEP[lang].pg8O2,\r\n                ]}\r\n                selected={this.state.showGrids ? 2 : 1}\r\n                selectMultiButton={this.clickMultiButton}\r\n              />\r\n            </div>\r\n            <div\r\n              id=\"assetGrid\"\r\n              style={{\r\n                clear: \"both\",\r\n                float: \"left\",\r\n                marginLeft: \"25px\",\r\n              }} /*    onClick={this.clone2}  */\r\n            >\r\n              {this.state.showGrids &&\r\n                this.AssetLiabProjs.projectionsGrids.map((grid) => {\r\n                  //console.log(grid.dataColTitles)\r\n                  return (\r\n                    <DataTable\r\n                      key={j++}\r\n                      dataColTitles={grid.dataColTitles}\r\n                      dataProjection={grid.dataProjection}\r\n                      gridTitle={grid.gridTitle}\r\n                      gridIcons={[]}\r\n                      specialRow={LE - startAge}\r\n                      language={lang}\r\n                    />\r\n                  );\r\n                })}\r\n            </div>\r\n          </div>\r\n\r\n          {logoBottom}\r\n          \r\n          {/* PAGE 9 notes*/}\r\n\r\n          <div style={styleWithLogo}>\r\n          {logoTop}\r\n            {/* {allPages && (\r\n              <AdjustibleImage\r\n                image={this.props.dataInput.Presentations[0].adviserLogo.image}\r\n                showDetails={false}\r\n                size={this.props.dataInput.Presentations[0].adviserLogo.size}\r\n                imageLeft={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.left\r\n                }\r\n                allPages={\r\n                  this.props.dataInput.Presentations[0].adviserLogo.allPages\r\n                }\r\n                imageRemove={this.props.imageRemove}\r\n                imageAdjust={this.props.imageAdjust}\r\n              />\r\n            )} */}\r\n            <br />\r\n            <h2 className=\"ppi1\">{OUTPUTTEXTEP[lang].pg9T}</h2>\r\n\r\n            <p className=\"ppi1\">{OUTPUTTEXTEP[lang].pg9P1}</p>\r\n            <p className=\"ppi1\">{OUTPUTTEXTEP[lang].pg9P2}</p>\r\n\r\n            {logoBottom}\r\n          \r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactExport from \"react-data-export\";\r\nimport { cleanFormat } from \"../../utils/helper\";\r\nimport { APPLET_INA,\r\n  APPLET_EP\r\n} from \"../../definitions/generalDefinitions\";\r\n\r\n\r\nconst ExcelFile = ReactExport.ExcelFile;\r\nconst ExcelSheet = ReactExport.ExcelFile.ExcelSheet;\r\n\r\nexport default class DownloadExcel extends React.Component {\r\n  render() {\r\n    // see https://github.com/securedeveloper/react-data-export for formatting\r\n    const styleCell = { alignment: { horizontal: \"right\" } ,font: {name: \"Trebuchet MS\"} , numFmt: \"##,##0\" };\r\n    const styleCellCol1 = { alignment: { horizontal: \"right\" } ,font: {name: \"Trebuchet MS\"} , numFmt: \"0\" };\r\n    const styleCellAlt = { alignment: { horizontal: \"right\" } ,font: {name: \"Trebuchet MS\"}, fill: { patternType: \"solid\", fgColor: { rgb: \"E9EAEB\" }}, numFmt: \"##,##0\" };\r\n    const styleCellAltCol1 = { alignment: { horizontal: \"right\" } ,font: {name: \"Trebuchet MS\"}, fill: { patternType: \"solid\", fgColor: { rgb: \"E9EAEB\" }}, numFmt: \"0\" };\r\n    const styleTitleRowInfo = {\r\n      font: {name: \"Trebuchet MS\", color: { rgb: \"FFFFFF\" }, bold: true},\r\n      alignment: { wrapText: true,horizontal: \"center\" },\r\n      border: {\r\n        top: { style: \"thin\", color: { rgb: \"C0C0C0\" } },\r\n        bottom: { style: \"thin\", color: { rgb: \"C0C0C0\" } },\r\n        right: { style: \"thin\", color: { rgb: \"C0C0C0\" } },\r\n        left: { style: \"thin\", color: { rgb: \"C0C0C0\" } }\r\n      },\r\n      fill: { patternType: \"solid\", fgColor: { rgb: \"7399c6\" } }\r\n    };\r\n    const styleCellLeftAllign = { alignment: { horizontal: \"left\" },font: {name: \"Trebuchet MS\"}};\r\n    const styleTitleRow = {\r\n      font: {name: \"Trebuchet MS\", color: { rgb: \"FFFFFF\" }, bold: true},\r\n      alignment: {wrapText: true , horizontal: \"center\" },\r\n      border: {\r\n        top: { style: \"thin\", color: { rgb: \"C0C0C0\" } },\r\n        bottom: { style: \"thin\", color: { rgb: \"C0C0C0\" } },\r\n        right: { style: \"thin\", color: { rgb: \"C0C0C0\" } },\r\n        left: { style: \"thin\", color: { rgb: \"C0C0C0\" } }\r\n      },\r\n      fill: { patternType: \"solid\", fgColor: { rgb: \"334D7C\" } }\r\n     \r\n    };\r\n\r\n    let excelColumnsDataInfoSection = [];\r\n    let title = [];\r\n    let dataBodyTitles = []\r\n    let dataBody = [];\r\n    let dataRow = [];\r\n    let j;\r\n    let i;\r\n    let dataCell;\r\n\r\n    // console.log(this.props.excelColumnsDataInfoSection);\r\n\r\n    // section 1 title and header data\r\n    dataRow = [];\r\n    const lang = this.props.language;\r\n    \r\n    // always name and its value: length 2\r\n\r\n    if (this.props.excelColumnsDataInfoSection !== undefined) {\r\n      for (j = 0; j < this.props.excelColumnsDataInfoSection.length; ++j) {\r\n        for (i = 0; i < this.props.excelColumnsDataInfoSection[0].length; ++i) {\r\n           dataCell =\r\n            this.props.excelColumnsDataInfoSection[j][i] === undefined\r\n              ? \"\"\r\n              : (this.props.excelColumnsDataInfoSection[j][i].toString().indexOf(\"%\")>=0 || isNaN(this.props.excelColumnsDataInfoSection[j][i].toString())===true  || this.props.excelColumnsDataInfoSection[j][i].toString()===\"\" ?\r\n              this.props.excelColumnsDataInfoSection[j][i].toString():\r\n                parseFloat(cleanFormat(this.props.excelColumnsDataInfoSection[j][i]),lang));\r\n          dataRow.push({\r\n            value: dataCell,\r\n            style: j === 0 ? styleTitleRowInfo : styleCell\r\n          });\r\n        }\r\n        excelColumnsDataInfoSection.push(dataRow);\r\n        dataRow = [];\r\n      }\r\n    }\r\n\r\n    // section 2 column headers and data\r\n    // add column titles as first data row to be able to style with another stupid libaray\r\n    // empty titles\r\n\r\n    if (this.props.excelColumnsHeaders !== undefined) {\r\n\r\n      title.push([{ value: this.props.title, style: {font: {sz: \"14\", name: \"Trebuchet MS\", bold: true}}}]);\r\n      \r\n      for (j = 0; j < this.props.excelColumnsHeaders.length; ++j) {\r\n        dataBodyTitles.push({ title: \"\", width: { wpx: this.props.width }, font: {name: \"Trebuchet MS\", bold: true}} );\r\n      }\r\n\r\n      for (j = 0; j < this.props.excelColumnsHeaders.length; ++j) {\r\n        \r\n        dataRow.push({ value: this.props.excelColumnsHeaders[j], style: styleTitleRow });\r\n      }\r\n      dataBody.push(dataRow);\r\n    }\r\n\r\n    dataRow = [];\r\n    if (this.props.excelColumnsDataMain !== undefined) {\r\n      for (i = 0; i < this.props.excelColumnsDataMain[0].length; ++i) {\r\n        for (j = 0; j < this.props.excelColumnsHeaders.length; ++j) {\r\n          dataCell =\r\n            this.props.excelColumnsDataMain[j][i] === undefined\r\n              ? \"\"\r\n              :(this.props.excelColumnsDataMain[j][i].toString().indexOf(\"%\")>=0 || isNaN(this.props.excelColumnsDataMain[j][i].toString())===true  || this.props.excelColumnsDataMain[j][i].toString()===\"\" ?\r\n              this.props.excelColumnsDataMain[j][i].toString():\r\n                parseFloat(cleanFormat(this.props.excelColumnsDataMain[j][i]),lang));\r\n\r\n          dataRow.push({\r\n            value: dataCell,\r\n            style: isNaN(parseFloat(cleanFormat(dataCell,lang)))\r\n              ? styleCellLeftAllign\r\n              : (i%2?(j===0?styleCellAltCol1:styleCellAlt):(j===0?styleCellCol1:styleCell))\r\n          });\r\n        }\r\n        dataBody.push(dataRow);\r\n        dataRow = [];\r\n      }\r\n    }\r\n    const multiDataSet = [\r\n      // section 1 title\r\n      {\r\n        columns: [],\r\n        data: title\r\n      },\r\n      // section 1 key values\r\n      {\r\n        columns: [],\r\n        data: excelColumnsDataInfoSection\r\n      },\r\n\r\n      // section 2\r\n      {\r\n        xSteps: 0,\r\n        ySteps: 1,\r\n        columns: dataBodyTitles,\r\n        data: dataBody\r\n      }\r\n    ];\r\n    var tempDate = new Date();\r\n    var date = tempDate.getDate()+ tempDate.toLocaleString('en-us', { month: 'short' })  + tempDate.getFullYear()\r\n\r\n    if (this.props.downloadNow === 0) return \"\";\r\n    else\r\n      return (\r\n        <ExcelFile hideElement={true} filename= {(APPLET_INA?\"INA\":\"PYE\") + \"_Data_\" + date}>\r\n          <ExcelSheet dataSet={multiDataSet} name={APPLET_INA?\"INAd\":\"PYE\" }/>\r\n        </ExcelFile>\r\n      );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\n//import { ReactComponent as Icon} from './icon.svg';\r\nimport \"./ExcelToolbar.css\";\r\n\r\nconst defaultToolbarStyles = {\r\n    iconButton: {\r\n    },\r\n};\r\n\r\nexport default class ExcelToolbar extends React.Component {\r\n\r\n    handleClick = () => {\r\n        this.props.setExcel();\r\n    };\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n        // console.log(\"classes\", classes)\r\n        const title=<span  style={{fontSize: '12px', marginBottom: '0px', margin: '0px', padding: '0px' }}  >{this.props.excelToolbarText}</span>\r\n        return (\r\n            <React.Fragment>\r\n                <Tooltip placement='left-end' style={{fontSize: '12px', margin: '0px', padding: '0px' }}   title={title}>\r\n                    <IconButton  onClick={this.handleClick}>\r\n                        <svg className=\"icon\" xmlns=\"http://www.w3.org/2000/svg\"   padding= '0px' width=\"30\" height=\"30\"  viewBox=\"0 0 24 24\"><path d=\"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z\"/></svg>\r\n                    </IconButton>\r\n                </Tooltip>\r\n            </React.Fragment>\r\n        );\r\n    }\r\n\r\n}\r\n","import React from \"react\";\r\nimport MUIDataTable from \"mui-datatables\";\r\nimport {\r\n  Typography,\r\n  TableRow,\r\n  TableCell,\r\n  Card,\r\n  CardContent\r\n} from \"@material-ui/core\";\r\nimport { createMuiTheme, MuiThemeProvider } from \"@material-ui/core/styles\";\r\nimport {GRID_INTERNAL_CAPTIONS} from '../../definitions/generalDefinitions';\r\n//import DownloadExcel from './DownloadExcel'\r\nimport DownloadExcel from \"./DownloadExcel\";\r\nimport ExcelToolbar from \"./ExcelToolbar\";\r\n//import PrintToolbar from \"./printToolbar\";\r\nimport {\r\n  getInfoIconNotes\r\n} from \"../../definitions/infoIconsDefinitions.js\";\r\nimport { Info } from \"../Info\";\r\n\r\n\r\nexport default class Datatable extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      downloadExcelNow: 0\r\n    };\r\n  }\r\n\r\n\r\n\r\n  getMuiTheme = () =>\r\n    createMuiTheme({\r\n      typography: {\r\n        fontFamily: '\"Trebuchet MS\"',\r\n        fontSize: 11,\r\n        fontWeight: \"100\"\r\n      },\r\n      overrides: {\r\n        MUIDataTable: {\r\n          tableRoot: {\r\n            margin: 0,\r\n            \r\n          },\r\n          paper: {\r\n            boxShadow: \"none\",\r\n            borderBottom:\"1px solid rgb(150, 150, 150)\",\r\n            borderRight:\"1px solid rgb(200, 200, 200)\",\r\n          }\r\n        },\r\n        MuiTableRow: {\r\n          root: {\r\n            //for the body\r\n            height: \"100%\"\r\n          },\r\n          head: {\r\n            //for the head\r\n            height: \"100%\"\r\n          },\r\n          footer: {\r\n            display: \"none\"\r\n          }\r\n        },\r\n        MuiTableCell: {\r\n          head: {\r\n            fontSize: \".8rem\"\r\n          },\r\n          \r\n          sizeSmall: {\r\n            padding: \"8px 3px 8px 3px\"\r\n          }\r\n\r\n        },\r\n        MUIDataTableToolbar: {\r\n          root: {\r\n            paddingLeft: \"0px\"\r\n          },\r\n          titleRoot: {\r\n            fontSize: 24,\r\n            fontWeight: 'bold'\r\n          },\r\n          icon: {\r\n            fontSize: 24\r\n          }\r\n        },\r\n        MUIDataTableBodyCell: {\r\n          root: {\r\n            backgroundColor: \"#FF0000\"\r\n           }\r\n        },\r\n        MUITypography: {\r\n          root: {\r\n            backgroundColor: \"blue\"\r\n           },\r\n           \r\n            body2: {\r\n              color: 'blue',\r\n            },\r\n        },\r\n        MUITablePagination: {\r\n          caption: {\r\n              value: 'blue',\r\n            },\r\n        }\r\n      }\r\n    });\r\n\r\n  setExcel = () => {\r\n    let downloadNow = this.state.downloadExcelNow === 1 ? 0 : 1;\r\n    this.setState({ downloadExcelNow: downloadNow });\r\n  };\r\n\r\n  render() {\r\n    let data = [];\r\n    let dataRow = [];\r\n    let j;\r\n    let i;\r\n\r\n\r\n    \r\n    let unit=65\r\n    let factor=1.3\r\n    if(this.props.dataColTitles.length<4) // for liabs\r\n      unit=95\r\n   \r\n      let divStyle={ width: factor*unit*(this.props.dataColTitles.length),  marginBottom:\"10px\"  }   \r\n    if(factor*unit*this.props.dataColTitles.length>(1/factor)* window.innerWidth)\r\n    {\r\n      unit=((1/factor)*window.innerWidth/(factor*this.props.dataColTitles.length))\r\n      divStyle={ width: factor*unit*(this.props.dataColTitles.length) }   \r\n    \r\n    } \r\n     if(unit<60)\r\n    {\r\n      unit=60 \r\n      divStyle={ width: \"100%\" } \r\n    } \r\n    \r\n    \r\n    let columns = [];\r\n\r\n    if (this.props.dataProjection !== undefined) {\r\n    \r\n      for (i = 0; i < this.props.dataProjection[0].length; ++i) {\r\n        for (j = 0; j < this.props.dataColTitles.length; ++j) {\r\n          if(j<1)\r\n          dataRow.push(this.props.dataProjection[j][i]);\r\n          else\r\n          dataRow.push(this.props.dataProjection[j][i]);\r\n        }\r\n        data.push(dataRow);\r\n        dataRow = [];\r\n      }\r\n\r\n      // build and style header and columns\r\n      let widthCustom =unit;// Math.max(80,6 * this.props.dataColTitles.length); //+'%';\r\n      let styleHeader = {\r\n        backgroundColor: \"#334d7c\",\r\n        color: \"#FFFFFF\",\r\n        textAlign: \"center\",\r\n        width: widthCustom,\r\n        fontWeight: \"bold\",\r\n        position: \"sticky\",\r\n        top: 0,\r\n        zIndex: 0,\r\n      };\r\n\r\n      let customHeader = ({ index, ...column }) => {\r\n        return (\r\n          \r\n          <TableCell key={index} style={styleHeader}>\r\n            {this.props.gridIcons !== undefined && \r\n            this.props.gridIcons[index] !== undefined && <div><Info infoIcon={this.props.gridIcons[index]}/><br/></div>} \r\n          {/* {index===this.props.headerIndex && <div><Info infoIcon={getInfoIconNotes(this.props.language)}/><br/></div>}  */}\r\n           {column.name}\r\n           </TableCell>\r\n        );\r\n      };\r\n\r\n      for (i = 0; i < this.props.dataColTitles.length; ++i) {\r\n        columns.push({\r\n          name: this.props.dataColTitles[i],\r\n          options: {\r\n            filter: false,\r\n            customHeadRender: customHeader\r\n          }\r\n        });\r\n      }\r\n    }\r\n    const captions= GRID_INTERNAL_CAPTIONS[this.props.language]\r\n    const title=<span style={{fontSize: '14px'}}  >{captions.excel}</span>\r\n            \r\n              \r\n    const excelToolbarText=captions.excel \r\n     const options = {\r\n      filter: false,\r\n      filterType: \"dropdown\",\r\n      selectableRows: \"none\",\r\n      responsive: \"scrollMaxHeight\", //this removes horiz\r\n      resizableColumns: true,\r\n      selectableRowsHeader: false,\r\n      viewColumns: false,\r\n      search: false,\r\n      download: false,\r\n      print:false,\r\n      textLabels:{\r\n        pagination: {\r\n          rowsPerPage: captions.rows,\r\n          displayRows: captions.of\r\n        },\r\n        \r\n      },\r\n      \r\n      rowsPerPage: 100,\r\n      setTableProps: () => {\r\n        return {\r\n          padding: \"default\",\r\n          size: \"small\",\r\n          margin: \"0px\"\r\n        };\r\n      },\r\n      downloadOptions: {\r\n        filename: \"INAtableDownload.csv\",\r\n        separator: \",\"\r\n      },\r\n      onDownload: (buildHead, buildBody, columns, data) => {\r\n        //handleCSVDownload2(data, columns);\r\n        this.setExcel();\r\n        //return \"\\uFEFF\" + \"dfof\\n \" + \"go to hell\\n\" + buildHead(headerNames) + buildBody(data);\r\n        return false;\r\n      },\r\n      customRowRender: (data, dataIndex, rowIndex) => {\r\n        let style = {textAlign: \"right\"};\r\n        if (data[0] === \"wwwwwww\") {\r\n          style.backgroundColor = \"green\";\r\n          style.fontSize = \"36px\";\r\n        }\r\n        var rows = [];\r\n\r\n        let i;\r\n        for (i = 0; i < this.props.dataColTitles.length; ++i) {\r\n          let dataI = data[i];\r\n          rows.push(\r\n            <TableCell key={i} style={style}>\r\n              <Typography>{\r\n /* this.formatMoney(\r\n  dataI,\r\n    this.props.gridColumnAligns[i],\r\n    \".\",\r\n    \",\"\r\n  ) } */dataI}</Typography>\r\n            </TableCell>\r\n          );\r\n        }\r\n        // console.log(rows)\r\n        return (\r\n          <TableRow key={rowIndex} style={{ backgroundColor: this.props.specialRow===undefined ? (rowIndex%2?\"#f9f9f9\":\"#e4e5e6\"):(rowIndex===this.props.specialRow?\"#d0d7e6\":(rowIndex%2?\"#f9f9f9\":\"#e4e5e6\")) }}>\r\n            {rows}\r\n          </TableRow>\r\n        );\r\n      },\r\n      customToolbar: () => <ExcelToolbar excelToolbarText={excelToolbarText} setExcel={this.setExcel} />\r\n    };\r\n\r\n   \r\n\r\n    return (\r\n        <div style={divStyle} >\r\n          \r\n        <MuiThemeProvider theme={this.getMuiTheme()}>\r\n          <MUIDataTable\r\n            title={this.props.gridTitle}\r\n            data={data}\r\n            columns={columns}\r\n            options={options}\r\n          />\r\n        </MuiThemeProvider>\r\n        {this.state.downloadExcelNow ===1 && <DownloadExcel\r\n          excelColumnsDataMain={this.props.dataProjection}\r\n          width={\"90\"}\r\n          excelColumnsHeaders={this.props.dataColTitles}\r\n          title={this.props.gridTitle}\r\n          excelColumnsDataInfoSection={this.props.gridColumnsDataExcelInfoSection}\r\n          downloadNow={this.state.downloadExcelNow}\r\n          hideElement={true}\r\n          language={this.props.language}\r\n        />}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","// Imports\r\nimport React, { Component } from \"react\";\r\nimport jsPDF from \"jspdf\";\r\n\r\n// Constants\r\nconst PORTRAIT = \"portrait\";\r\nconst PT = \"pt\";\r\nconst LETTER = \"letter\";\r\n\r\nconst PNG = \"png\";\r\n\r\nexport const HELVETICA = \"Helvetica\";\r\nexport const TIMES = \"Times\";\r\n\r\nexport const NORMAL = \"normal\";\r\nexport const BOLD = \"bold\";\r\nexport const ITALIC = \"italic\";\r\n\r\nexport const HEADER_RECT_IN_X: number = 1;\r\nexport const HEADER_RECT_IN_Y: number = 0.48;\r\nexport const HEADER_RECT_IN_W: number = 6.4;\r\nexport const HEADER_RECT_IN_H: number = 0.45;\r\nexport const HEADER_RECT_R: number = 148;\r\nexport const HEADER_RECT_G: number = 148;\r\nexport const HEADER_RECT_B: number = 148;\r\n\r\nexport const HEADER_TEXT_PT_SIZE: number = 10;\r\nexport const HEADER_TEXT_IN_X: number = 1;\r\nexport const HEADER_TEXT_IN_Y: number = 0.75;\r\nexport const HEADER_TEXT_IN_W: number = 6;\r\nexport const HEADER_TEXT_R: number = 0xff;\r\nexport const HEADER_TEXT_G: number = 0xff;\r\nexport const HEADER_TEXT_B: number = 0xff;\r\n\r\nexport const FOOTER_TEXT_PT_SIZE: number = 8;\r\nexport const FOOTER_TEXT_IN_X: number = 1.5;\r\nexport const FOOTER_TEXT_IN_Y: number = 11 - 3 * 0.125;\r\nexport const FOOTER_TEXT_IN_Y_L: number = 8 - 3 * 0.125;\r\n\r\nexport const TEXT_R: number = 0x45;\r\nexport const TEXT_G: number = 0x55;\r\nexport const TEXT_B: number = 0x60;\r\n\r\nexport const MAX_LOGO_HEIGHT = 0.38;\r\n// Functions\r\nexport const InToPt = (in_) => {\r\n  return in_ * 25;\r\n};\r\n\r\nexport const PxToPt = (px) => {\r\n  return (px / 96) * 72;\r\n};\r\n\r\nconst fontName = HELVETICA;\r\nconst fontStyle = NORMAL;\r\nconst fontSize = 16;\r\n\r\nconst textRed = 0x00;\r\nconst textGreen = 0x00;\r\nconst textBlue = 0x00;\r\n\r\nconst fillRed = 0xff;\r\nconst fillGreen = 0xff;\r\nconst fillBlue = 0xff;\r\n\r\nconst showGrids = true;\r\n\r\nconst PAGE_WIDTH = 8.4;\r\nexport const PAGE_HEIGHT = 11;\r\nconst PAGE_USED_AREA_LEFT = 1.2;\r\nconst PAGE_USED_AREA_RIGHT = 7.24;\r\n\r\n// Classes\r\nexport class PDF extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {};\r\n    this.pdf = new jsPDF();\r\n  }\r\n\r\n  AddImage = (imageID, x, y, w, h) => {\r\n    if (this.pdf === null) return;\r\n    const imgData = document.getElementById(imageID);\r\n    const imgProps = this.pdf.getImageProperties(imgData);\r\n    const pdfHeight = (imgProps.height * w) / imgProps.width;\r\n    if (pdfHeight > h) {\r\n      w = (imgProps.width * h) / imgProps.height;\r\n    } else h = pdfHeight;\r\n    this.pdf.addImage(document.getElementById(imageID), PNG, x, y, w, h);\r\n  };\r\n\r\n  AddImageFitWidthOnly = (imageID, x, y, w, maxHeight) => {\r\n    if (this.pdf === null) return;\r\n    let imgData = document.getElementById(imageID);\r\n\r\n    if (imgData !== null) {\r\n      try {\r\n        const imgProps = this.pdf.getImageProperties(imgData);\r\n\r\n        //const pdfWidth = this.pdf.internal.pageSize.getWidth();\r\n        let pdfHeight = (imgProps.height * w) / imgProps.width;\r\n\r\n        if (pdfHeight > maxHeight) {\r\n          if (x + w > (3 * InToPt(PAGE_WIDTH)) / 4)\r\n            x += w - (w * maxHeight) / pdfHeight;\r\n          else if (x + (w * maxHeight) / pdfHeight / 2 > InToPt(PAGE_WIDTH) / 4)\r\n            x += w / 2 - (w * maxHeight) / pdfHeight / 2;\r\n\r\n          /*  else if(x+w/2>InToPt(PAGE_WIDTH/4))\r\n          x-=(w-w*maxHeight / pdfHeight)/2 */\r\n\r\n          w *= maxHeight / pdfHeight;\r\n          pdfHeight = maxHeight;\r\n        }\r\n        this.pdf.addImage(imgData, PNG, x, y, w, pdfHeight);\r\n        return true;\r\n      } catch (error) {\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n\r\n  addCustomImage = (id, pg1TitleY, image, firstPage, top) => {\r\n     const left =\r\n      image === null || image === undefined\r\n        ? 0\r\n        : (image.left * HEADER_RECT_IN_W) / 100;\r\n    const result = this.AddImageFitWidthOnly(\r\n      id,\r\n      InToPt(pg1TitleY - 3 + left), //1.51),\r\n      InToPt(\r\n        firstPage\r\n          ? top\r\n            ? 1.06\r\n            : FOOTER_TEXT_IN_Y + 0.25\r\n          : top\r\n          ? 0.29\r\n          : FOOTER_TEXT_IN_Y + 0.25\r\n      ),\r\n      InToPt((6.04 * image.size) / 100),\r\n      InToPt(firstPage ? (top ? 2.76 : MAX_LOGO_HEIGHT) : MAX_LOGO_HEIGHT) // max height\r\n    );\r\n    return result;\r\n  };\r\n\r\n  AddChart = (containerID, x, y, w, h) => {\r\n    if (this.pdf === null) return;\r\n\r\n    const CANVAS_CLASS_NAME = \"chartjs-render-monitor\";\r\n\r\n    let containerElement = document.getElementById(containerID);\r\n    let canvasElement = null;\r\n\r\n    if (containerElement !== null)\r\n      if (\r\n        containerElement.getElementsByClassName(CANVAS_CLASS_NAME).length === 1\r\n      )\r\n        canvasElement = containerElement.getElementsByClassName(\r\n          CANVAS_CLASS_NAME\r\n        )[0];\r\n\r\n    let dataUrl = canvasElement.toDataURL();\r\n\r\n    if (dataUrl !== null) this.pdf.addImage(dataUrl, \"JPEG\", x, y, w, h);\r\n  };\r\n\r\n  AddCanvas = (canvasID, x, y, w, h) => {\r\n    if (this.pdf === null) return;\r\n\r\n    let canvasElement = null;\r\n    let dataUrl = null;\r\n\r\n    canvasElement = document.getElementById(canvasID);\r\n\r\n    if (canvasElement !== null) dataUrl = canvasElement.toDataURL();\r\n\r\n    if (dataUrl !== null) this.pdf.addImage(dataUrl, \"JPEG\", x, y, w, h);\r\n  };\r\n\r\n  AddPage = (mode) => {\r\n    if (this.pdf === null) return;\r\n\r\n    this.pdf.addPage(\"\", mode);\r\n  };\r\n\r\n  Create = () => {\r\n    if (this.pdf !== null) return;\r\n\r\n    this.pdf = new jsPDF({\r\n      orientation: PORTRAIT,\r\n      unit: PT,\r\n      format: LETTER,\r\n    });\r\n  };\r\n\r\n  ShowGrids = () => {\r\n    return this.showGrids;\r\n  };\r\n\r\n  ShowGrids = (showGrids) => {\r\n    this.showGrids = showGrids;\r\n  };\r\n\r\n  Grid = () => {\r\n    if (this.pdf === null) return;\r\n\r\n    if (this.showGrids === false) return;\r\n\r\n    const FONT_SIZE = 12;\r\n    const LARGE_FONT_SIZE = 16;\r\n\r\n    this.pdf.setFontSize(12);\r\n    this.pdf.setFont(HELVETICA, NORMAL);\r\n    this.pdf.setTextColor(0x00, 0x88, 0x00);\r\n\r\n    let x;\r\n    let y;\r\n\r\n    this.pdf.text(\"0\", 0, FONT_SIZE);\r\n\r\n    for (x = 1; x <= 8; x++) this.pdf.text(\"\" + x, InToPt(x), FONT_SIZE);\r\n\r\n    for (y = 1; y <= 11; y++) this.pdf.text(\"\" + y, 0, InToPt(y));\r\n\r\n    for (x = 0.25; x <= 8.5; x += 0.25)\r\n      for (y = 0.25; y <= 11; y += 0.25)\r\n        this.pdf.text(\".\", InToPt(x), InToPt(y));\r\n\r\n    this.pdf.setFont(HELVETICA, BOLD);\r\n    this.pdf.setFontSize(LARGE_FONT_SIZE);\r\n    for (x = 1; x <= 8; x += 1)\r\n      for (y = 1; y <= 11; y += 1) this.pdf.text(\".\", InToPt(x), InToPt(y));\r\n\r\n    if (this.fontSize !== null) this.pdf.setFontSize(this.fontSize);\r\n\r\n    if (\r\n      this.textRed !== null &&\r\n      this.textGreen !== null &&\r\n      this.textBlue !== null\r\n    )\r\n      this.pdf.setTextColor(this.textRed, this.textGreen, this.textBlue);\r\n\r\n    if (this.fontName !== null && this.fontStyle !== null)\r\n      this.pdf.setFont(this.fontName, this.fontStyle);\r\n  };\r\n\r\n  MultilineText = (text, x, y, w) => {\r\n    if (this.pdf === null) return;\r\n\r\n    let textLines = [];\r\n\r\n    textLines = this.pdf.splitTextToSize(text, w, {\r\n      fontName: this.fontName,\r\n      fontSize: this.fontSize,\r\n    });\r\n\r\n    this.pdf.text(textLines, x, y);\r\n  };\r\n\r\n  DrawLine = (x, y, w) => {\r\n    this.pdf.line(x, y, x + w, y);\r\n  };\r\n\r\n  Reset = () => {\r\n    this.pdf = null;\r\n  };\r\n\r\n  SetFont = (fontName, fontStyle) => {\r\n    if (this.pdf === null) return;\r\n\r\n    this.pdf.setFont(fontName, fontStyle);\r\n\r\n    this.fontName = fontName;\r\n    this.fontStyle = fontStyle;\r\n  };\r\n\r\n  SetFontSize = (fontSize) => {\r\n    if (this.pdf === null) return;\r\n\r\n    this.pdf.setFontSize(fontSize);\r\n\r\n    this.fontSize = fontSize;\r\n  };\r\n\r\n  Save = (fileName) => {\r\n    if (this.pdf === null) return;\r\n\r\n    this.pdf.save(fileName);\r\n  };\r\n\r\n  SetTextColor = (red, green, blue) => {\r\n    if (this.pdf === null) return;\r\n\r\n    this.pdf.setTextColor(red, green, blue);\r\n\r\n    this.textRed = red;\r\n    this.textGreen = green;\r\n    this.textBlue = blue;\r\n  };\r\n\r\n  SetFillColor = (red, green, blue) => {\r\n    if (this.pdf === null) return;\r\n\r\n    this.pdf.setFillColor(red, green, blue);\r\n\r\n    this.fillRed = red;\r\n    this.fillGreen = green;\r\n    this.fillBlue = blue;\r\n  };\r\n\r\n  showOnPage = () => {\r\n    //this.pdf.output('datauri');\r\n    //window.open(this.pdf.output('bloburl'))\r\n    //this.pdf.output('dataurlnewwindow');\r\n    //return this.pdf.output('datauri')\r\n    var blob = this.pdf.output(\"bloburl\");\r\n    return blob;\r\n  };\r\n  Rectangle = (x, y, w, h) => {\r\n    if (this.pdf === null) return;\r\n\r\n    this.pdf.roundedRect(x, y, w, h, 0, 0, \"F\");\r\n  };\r\n\r\n  textWidth = (text) => {\r\n    var arrayText = text.split(\" \");\r\n    let minWidth = 0;\r\n    //console.log(arrayText)\r\n    for (let i = 0; i < arrayText.length; i++) {\r\n      minWidth = Math.max(minWidth, this.pdf.getTextWidth(arrayText[i]));\r\n    }\r\n    return minWidth / 25; // pt to int\r\n  };\r\n  textWidthMultiLine = (text, width) => {\r\n    let arrayText = this.pdf.splitTextToSize(text, InToPt(width));\r\n    let minWidth = 0;\r\n    for (let i = 0; i < arrayText.length; i++) {\r\n      minWidth = Math.max(minWidth, this.pdf.getTextWidth(arrayText[i]));\r\n    }\r\n    return minWidth / 25; // pt to int\r\n  };\r\n\r\n  adjustTextWidth = (arrayText) => {\r\n    let minWidth = 0;\r\n    for (let i = 0; i < arrayText.length; i++) {\r\n      minWidth = Math.max(minWidth, this.pdf.getTextWidth(arrayText[i]));\r\n    }\r\n    return minWidth / 25; // pt to int\r\n  };\r\n\r\n  tableRow = (\r\n    fill,\r\n    textColor,\r\n    x,\r\n    y,\r\n    values,\r\n    height,\r\n    Widths,\r\n    box,\r\n    align,\r\n    title\r\n  ) => {\r\n    const lines2Fac = 1.75;\r\n    const lines3Fac = 2.7;\r\n    const cols = values.length;\r\n    let textY = y + height / 2 + 0.05;\r\n    // wrap if needed\r\n    let h = height;\r\n    for (i = 1; i <= cols; i++) {\r\n      if (\r\n        this.pdf.getTextWidth(values[i - 1]) > 2 * InToPt(Widths[i - 1]) &&\r\n        h < parseFloat(lines3Fac * height)\r\n      ) {\r\n        //console.log(values[i - 1],this.pdf.getTextWidth(values[i - 1]),.8*InToPt(Widths[i - 1]))\r\n        h = lines3Fac * height;\r\n        textY = y + height / 2 + 0.07;\r\n      } else if (\r\n        this.pdf.getTextWidth(values[i - 1]) > InToPt(Widths[i - 1]) &&\r\n        h < parseFloat(lines2Fac * height)\r\n      ) {\r\n        //console.log(values[i - 1],this.pdf.getTextWidth(values[i - 1]),.8*InToPt(Widths[i - 1]))\r\n        h = lines2Fac * height;\r\n        textY = y + height / 2 + 0.07;\r\n      }\r\n      let textOut;\r\n      if (h > height) {\r\n        textOut = this.pdf.splitTextToSize(\r\n          values[i - 1],\r\n          InToPt(Widths[i - 1] - 0.1)\r\n        );\r\n        // adjust width if necessary\r\n        //console.log(textOut,h,height)\r\n        if (title === true) {\r\n          if (textOut.length > 2 && h < parseFloat(lines3Fac * height))\r\n            h = lines3Fac * height;\r\n          else if (textOut.length > 1 && h < parseFloat(lines2Fac * height))\r\n            h = lines2Fac * height;\r\n          textY = y + height / 2 + 0.07;\r\n          // console.log(textOut,h,height)\r\n        }\r\n      }\r\n    }\r\n    this.SetTextColor(textColor[0], textColor[1], textColor[2]);\r\n    //this.SetFontSize(12);\r\n    var i;\r\n    let rightAlign;\r\n    let xi = x;\r\n    for (i = 1; i <= cols; i++) {\r\n      // wrap if needed\r\n      let textOut;\r\n      if (h > height) {\r\n        textOut = this.pdf.splitTextToSize(\r\n          values[i - 1],\r\n          InToPt(Widths[i - 1] - 0.1)\r\n        );\r\n      } else {\r\n        textOut = values[i - 1];\r\n        if (align !== undefined) {\r\n          if (align[i - 1] !== undefined) {\r\n            if (align[i - 1] === 2) rightAlign = true;\r\n          }\r\n        }\r\n      }\r\n      this.SetFillColor(fill[0], fill[1], fill[2]);\r\n      this.Rectangle(\r\n        InToPt(xi),\r\n        InToPt(y),\r\n        InToPt(Widths[i - 1] + 0.1),\r\n        InToPt(h)\r\n      );\r\n      if (box) {\r\n        this.pdf.setDrawColor(155, 155, 155);\r\n        this.pdf.rect(\r\n          InToPt(xi),\r\n          InToPt(y),\r\n          InToPt(Widths[i - 1] + 0.1),\r\n          InToPt(h)\r\n        );\r\n      }\r\n      if (rightAlign)\r\n        this.RightText(\r\n          values[i - 1],\r\n          InToPt(xi - 0.05),\r\n          InToPt(textY),\r\n          InToPt(Widths[i - 1])\r\n        );\r\n      else this.pdf.text(textOut, InToPt(xi + 0.1), InToPt(textY));\r\n\r\n      //  this.MultilineText(values[i - 1], InToPt(xi + .1), InToPt(y + .25), InToPt(3));\r\n      xi += Widths[i - 1];\r\n    }\r\n    //pdf.SetFillColor(fill[0], fill[1], fill[2]);\r\n    //pdf.Rectangle(InToPt(x), InToPt(y), InToPt(w), InToPt(height));\r\n    //pdf.Text(\"Family Profile\", InToPt(x[0] + .1), InToPt(y + .25));\r\n    //pdf.SetFillColor(115, 153, 198);\r\n    //pdf.Rectangle(InToPt(x[1]), InToPt(y), InToPt(w), InToPt(0.4));\r\n    //pdf.Text(\"Income\", InToPt(x[1] + .1), InToPt(y + .25));\r\n    //pdf.SetFillColor(115, 153, 198);\r\n    //pdf.Rectangle(InToPt(x[2]), InToPt(y), InToPt(w), InToPt(0.4));\r\n    //pdf.Text(\"Retirement Age\", InToPt(x[2] + .1), InToPt(y + .25));\r\n\r\n    return h - height; // excess height from here\r\n  };\r\n\r\n  Text = (text, x, y) => {\r\n    if (this.pdf === null) return;\r\n\r\n    this.pdf.text(text, x, y);\r\n  };\r\n\r\n  CenterText = (text, x, y, w) => {\r\n    if (this.pdf === null) return;\r\n\r\n    let tw = this.pdf.getTextWidth(text);\r\n\r\n    this.pdf.text(text, x + (w - tw) / 2, y);\r\n  };\r\n\r\n  RightText = (text, x, y, w) => {\r\n    if (this.pdf === null) return;\r\n\r\n    let tw = this.pdf.getTextWidth(text);\r\n\r\n    this.pdf.text(text, x + (w - tw) + 0.1, y);\r\n  };\r\n\r\n  Header = (textH, headerOffset) => {\r\n    if (headerOffset === undefined) headerOffset = 0;\r\n    this.SetFillColor(HEADER_RECT_R, HEADER_RECT_G, HEADER_RECT_B);\r\n\r\n    this.Rectangle(\r\n      InToPt(HEADER_RECT_IN_X),\r\n      InToPt(HEADER_RECT_IN_Y + headerOffset),\r\n      InToPt(HEADER_RECT_IN_W),\r\n      InToPt(HEADER_RECT_IN_H)\r\n    );\r\n\r\n    this.SetTextColor(HEADER_TEXT_R, HEADER_TEXT_G, HEADER_TEXT_B);\r\n    this.SetFont(HELVETICA, NORMAL);\r\n    this.SetFontSize(HEADER_TEXT_PT_SIZE);\r\n    this.CenterText(\r\n      textH,\r\n      InToPt(HEADER_TEXT_IN_X),\r\n      InToPt(HEADER_TEXT_IN_Y + headerOffset),\r\n      InToPt(HEADER_TEXT_IN_W)\r\n    );\r\n  };\r\n\r\n  addFooterAndHeader = (headerOffset, footerText, headerText) => {\r\n    this.Footer(footerText);\r\n    this.AddPage();\r\n    this.Header(headerText, headerOffset);\r\n  };\r\n\r\n  Footer = (textF) => {\r\n    this.SetTextColor(TEXT_R, TEXT_G, TEXT_B);\r\n    this.SetFont(TIMES, NORMAL);\r\n    this.SetFontSize(FOOTER_TEXT_PT_SIZE);\r\n    this.Text(textF, InToPt(FOOTER_TEXT_IN_X), InToPt(FOOTER_TEXT_IN_Y));\r\n  };\r\n\r\n  FooterLandscape = (textF) => {\r\n    this.SetTextColor(TEXT_R, TEXT_G, TEXT_B);\r\n    this.SetFont(TIMES, NORMAL);\r\n    this.SetFontSize(FOOTER_TEXT_PT_SIZE);\r\n    this.Text(textF, InToPt(FOOTER_TEXT_IN_X), InToPt(FOOTER_TEXT_IN_Y_L));\r\n  };\r\n\r\n  drawRect(paraLeft, paraY, paraWidth, height, color) {\r\n    this.SetFillColor(color[0], color[1], color[2]);\r\n    this.pdf.rect(\r\n      InToPt(paraLeft),\r\n      InToPt(paraY),\r\n      InToPt(paraWidth),\r\n      InToPt(height),\r\n      \"F\"\r\n    );\r\n  }\r\n\r\n  addFooter = (footer, title) => {\r\n    this.Footer(footer);\r\n    this.AddPage();\r\n    this.Header(title);\r\n  };\r\n\r\n  addHeaderNoFooter = (headerOffset, headerText) => {\r\n    this.AddPage();\r\n    this.Header(headerText, headerOffset);\r\n  };\r\n\r\n  tableRowSingle = (\r\n    fill,\r\n    textColor,\r\n    x,\r\n    y,\r\n    values2,\r\n    height,\r\n    Widths,\r\n    coloured\r\n  ) => {\r\n    const values = [values2];\r\n\r\n    if (coloured)\r\n      // has colour\r\n      this.tableRow(fill, textColor, x, y + 0.1, values, height - 0.1, [1.2]);\r\n    else this.tableRow(fill, textColor, x, y, values, height, Widths);\r\n  };\r\n\r\n}"],"sourceRoot":""}